"use strict";(self.webpackChunkloan_calculator=self.webpackChunkloan_calculator||[]).push([[323],{122:function(t,e,a){var n=a(287),i=a(478);e.A=class{constructor(t={}){this.storageKey=t.storageKey||"loan-calculator-data",this.version=t.version||"1.0",this._initializeStorage()}_initializeStorage(){try{const t=localStorage.getItem(this.storageKey);if(t){const e=JSON.parse(t);e.version!==this.version&&this._migrateData(e)}else{const t={version:this.version,lastUpdated:(new Date).toISOString(),calculations:[]};localStorage.setItem(this.storageKey,JSON.stringify(t))}}catch(t){}}_migrateData(t){const e={...t,version:this.version,lastUpdated:(new Date).toISOString()};e.calculations||(e.calculations=[]);try{localStorage.setItem(this.storageKey,JSON.stringify(e))}catch(a){}}_getData(){try{const t=localStorage.getItem(this.storageKey);return t?JSON.parse(t):null}catch(t){return null}}_saveData(t){try{return t.lastUpdated=(new Date).toISOString(),localStorage.setItem(this.storageKey,JSON.stringify(t)),!0}catch(e){return"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name&&22!==e.code||this._handleStorageLimit(),!1}}_handleStorageLimit(){try{const t=this._getData();t&&t.calculations&&t.calculations.length>0&&(t.calculations.sort((t,e)=>new Date(t.updatedAt)-new Date(e.updatedAt)),t.calculations.shift(),this._saveData(t))}catch(t){}}saveCalculation(t,e=null){try{if(!t)throw new Error("No loan data provided");const a=this._getData();if(!a)throw new Error("Could not access storage");const n={loan:t.toJSON(),amortizationSchedule:e?e.toJSON():null,savedAt:(new Date).toISOString()},i=a.calculations.findIndex(e=>e.loan.id===t.id);if(i>=0?a.calculations[i]=n:a.calculations.push(n),this._saveData(a))return t.id;throw new Error("Failed to save calculation")}catch(a){return""}}getCalculations(){try{const t=this._getData();return t&&t.calculations?t.calculations.map(t=>({loan:n.Ay.fromJSON(t.loan),savedAt:new Date(t.savedAt)})):[]}catch(t){return[]}}getCalculationById(t){try{if(!t)throw new Error("No ID provided");const e=this._getData();if(!e||!e.calculations)return null;const a=e.calculations.find(e=>e.loan.id===t);if(!a)return null;const s=n.Ay.fromJSON(a.loan);let r=null;return a.amortizationSchedule&&(r=i.AmortizationSchedule.fromJSON(a.amortizationSchedule,s)),{loan:s,amortizationSchedule:r,savedAt:new Date(a.savedAt)}}catch(e){return null}}updateCalculation(t,e,a=null){try{if(!t||!e)throw new Error("ID and updated loan data are required");e.id!==t&&(e.id=t);return this.saveCalculation(e,a)===t}catch(n){return!1}}deleteCalculation(t){try{if(!t)throw new Error("No ID provided");const e=this._getData();if(!e||!e.calculations)return!1;const a=e.calculations.findIndex(e=>e.loan.id===t);return-1!==a&&(e.calculations.splice(a,1),this._saveData(e))}catch(e){return!1}}clearAllCalculations(){try{const t=this._getData();return!!t&&(t.calculations=[],this._saveData(t))}catch(t){return!1}}isStorageAvailable(){try{const t="__storage_test__";localStorage.setItem(t,t);const e=localStorage.getItem(t)===t;return localStorage.removeItem(t),e}catch(t){return!1}}getStorageStats(){try{const t=this._getData(),e=JSON.stringify(t),a=new Blob([e]).size,n=5242880;return{usedBytes:a,usedKB:Math.round(a/1024),totalBytes:n,totalKB:Math.round(n/1024),percentUsed:Math.round(a/n*100),itemCount:t&&t.calculations?t.calculations.length:0,isNearingLimit:a>.8*n}}catch(t){return{usedBytes:0,usedKB:0,totalBytes:0,totalKB:0,percentUsed:0,itemCount:0,isNearingLimit:!1}}}}},287:function(t,e,a){a.d(e,{_2:function(){return i},fx:function(){return n}});const n={mortgage:{defaultTerm:360,defaultRate:4.5,minAmount:1e4,maxAmount:1e7,description:"Home Mortgage"},auto:{defaultTerm:60,defaultRate:5,minAmount:1e3,maxAmount:2e5,description:"Auto Loan"},personal:{defaultTerm:36,defaultRate:10,minAmount:1e3,maxAmount:5e4,description:"Personal Loan"},student:{defaultTerm:120,defaultRate:5.5,minAmount:1e3,maxAmount:5e5,description:"Student Loan"}},i={monthly:{paymentsPerYear:12,description:"Monthly"},"bi-weekly":{paymentsPerYear:26,description:"Bi-Weekly"},weekly:{paymentsPerYear:52,description:"Weekly"}};class s{constructor(t={}){this.id=t.id||this.generateUniqueId(),this.name=t.name||"Unnamed Calculation",this.type=this.validateLoanType(t.type||"mortgage");const e=n[this.type];this.principal=this.validateNumber(t.principal,e.minAmount,e.minAmount,e.maxAmount),this.interestRate=this.validateNumber(t.interestRate,e.defaultRate,0,30),this.term=this.validateNumber(t.term,e.defaultTerm,1,600),this.paymentFrequency=this.validatePaymentFrequency(t.paymentFrequency||"monthly"),this.downPayment=this.validateNumber(t.downPayment,0,0,this.principal),this.additionalPayment=this.validateNumber(t.additionalPayment,0,0),this.inflationRate=this.validateNumber(t.inflationRate,2.5,0,20),this.startDate=t.startDate instanceof Date?t.startDate:new Date,this.createdAt=t.createdAt instanceof Date?t.createdAt:new Date,this.updatedAt=t.updatedAt instanceof Date?t.updatedAt:new Date,this.validate()}totalLoanAmount(){return Math.max(0,this.principal-this.downPayment)}numberOfPayments(){const{paymentsPerYear:t}=i[this.paymentFrequency];return Math.ceil(this.term*t/12)}periodicInterestRate(){const{paymentsPerYear:t}=i[this.paymentFrequency];return this.interestRate/100/t}paymentAmount(){const t=this.totalLoanAmount(),e=this.periodicInterestRate(),a=this.numberOfPayments();if(t<=0)return 0;if(e<=0)return t/a;return t*e*(1+e)**a/((1+e)**a-1)}totalInterest(){return this.paymentAmount()*this.numberOfPayments()-this.totalLoanAmount()}payoffDate(){const t=new Date(this.startDate);switch(this.paymentFrequency){case"monthly":default:t.setMonth(t.getMonth()+this.term);break;case"bi-weekly":t.setDate(t.getDate()+Math.ceil(14*this.numberOfPayments()));break;case"weekly":t.setDate(t.getDate()+Math.ceil(7*this.numberOfPayments()))}return t}generateUniqueId(){return`loan_${Date.now()}_${Math.floor(1e6*Math.random())}`}validateLoanType(t){if(!n[t]){const e=Object.keys(n).join(", ");throw new Error(`Invalid loan type: ${t}. Valid types are: ${e}`)}return t}validatePaymentFrequency(t){if(!i[t]){const e=Object.keys(i).join(", ");throw new Error(`Invalid payment frequency: ${t}. Valid frequencies are: ${e}`)}return t}validateNumber(t,e,a=null,n=null){const i="string"===typeof t?parseFloat(t):t;return isNaN(i)||"number"!==typeof i?e:null!==a&&i<a?a:null!==n&&i>n?n:i}validate(){const t=[];return this.principal<=0&&t.push("Principal amount must be greater than zero"),this.interestRate<0?t.push("Interest rate cannot be negative"):this.interestRate>20&&t.push("Warning: Interest rate is unusually high"),this.term<=0&&t.push("Loan term must be greater than zero"),this.downPayment<0?t.push("Down payment cannot be negative"):this.downPayment>=this.principal&&t.push("Down payment cannot be greater than or equal to the principal"),this.additionalPayment<0?t.push("Additional payment cannot be negative"):this.additionalPayment>this.paymentAmount()&&this.paymentAmount()>0&&t.push("Additional payment is greater than the regular payment"),{isValid:0===t.length,warnings:t}}update(t={}){const e=new Date,a=new s({...this.toJSON(),...t,updatedAt:e});return a.id=this.id,a.createdAt=this.createdAt,a.updatedAt<=this.updatedAt&&(a.updatedAt=new Date(this.updatedAt.getTime()+1)),a}toJSON(){return{id:this.id,name:this.name,type:this.type,principal:this.principal,interestRate:this.interestRate,term:this.term,paymentFrequency:this.paymentFrequency,downPayment:this.downPayment,additionalPayment:this.additionalPayment,inflationRate:this.inflationRate,startDate:this.startDate.toISOString(),createdAt:this.createdAt.toISOString(),updatedAt:this.updatedAt.toISOString()}}calculateAdditionalPaymentImpact(t=this.additionalPayment){const e=this.update({additionalPayment:0}),n=this.update({additionalPayment:t});return Promise.resolve().then(a.bind(a,478)).then(({AmortizationSchedule:a})=>{const i=new a(e),s=new a(n),r=i.payments.length-s.payments.length,o=i.totalInterest(),l=s.totalInterest(),c=o-l;let d=0,u=0;switch(this.paymentFrequency){case"monthly":default:d=r;break;case"bi-weekly":d=Math.round(12*r/26);break;case"weekly":d=Math.round(12*r/52)}u=Math.floor(d/12),d%=12;return{paymentsSaved:r,interestSaved:c,timeSavedMonths:d,timeSavedYears:u,newPayoffDate:s.payoffDate(),originalTerm:this.term,newTerm:this.term-d-12*u,originalPayment:e.paymentAmount(),newPayment:n.paymentAmount()+t,originalTotalInterest:o,newTotalInterest:l}})}calculateRefinance(t){if(!t.interestRate&&0!==t.interestRate)throw new Error("New interest rate is required for refinance calculation");return Promise.resolve().then(a.bind(a,478)).then(({AmortizationSchedule:e})=>{const a=new e(this),n=a.payments.length>0?a.payments[0].balance:this.totalLoanAmount(),i={principal:t.principal||n,interestRate:t.interestRate,term:t.term||this.term,paymentFrequency:t.paymentFrequency||this.paymentFrequency,additionalPayment:t.additionalPayment||0,startDate:new Date,name:"Refinance Option"},r=new s(i),o=new e(r),l=a.payments.length,c=a.totalInterest(),d=o.payments.length,u=o.totalInterest(),m=this.paymentAmount(),h=r.paymentAmount(),p=m-h,y=t.closingCosts||0,g=c+n,f=u+i.principal+y,v=g-f,b=p>0?Math.ceil(y/p):1/0;return{currentLoan:{payment:m,remainingBalance:n,remainingPayments:l,remainingInterest:c,totalCost:g},newLoan:{payment:h,principal:i.principal,term:i.term,interestRate:i.interestRate,totalPayments:d,totalInterest:u,totalCost:f},comparison:{monthlySavings:p,lifetimeSavings:v,closingCosts:y,breakEvenMonths:b,isWorthwhile:v>0&&b<d},refinanceLoan:r}})}static fromJSON(t){if(!t)return new s;const e={...t,startDate:t.startDate?new Date(t.startDate):new Date,createdAt:t.createdAt?new Date(t.createdAt):new Date,updatedAt:t.updatedAt?new Date(t.updatedAt):new Date},a=new s(e);return t.id&&(a.id=t.id),a}static createDefault(t="mortgage"){if(!n[t])throw new Error(`Invalid loan type: ${t}`);const e=n[t];return new s({name:`New ${e.description}`,type:t,principal:2*e.minAmount,interestRate:e.defaultRate,term:e.defaultTerm,paymentFrequency:"monthly",downPayment:0,additionalPayment:0,startDate:new Date})}static calculateAffordableLoan(t){if(!t.desiredPayment||t.desiredPayment<=0)throw new Error("Desired payment must be greater than zero");const{desiredPayment:e}=t,a=t.interestRate||4.5,n=t.term||360,i=t.paymentFrequency||"monthly",r=t.downPayment||0,o=new s({principal:1e5,interestRate:a,term:n,paymentFrequency:i,downPayment:0}),l=o.periodicInterestRate(),c=o.numberOfPayments();let d=0;d=l<=0?e*c:e*((1+l)**c-1)/(l*(1+l)**c);const u=d+r,m=new s({principal:u,interestRate:a,term:n,paymentFrequency:i,downPayment:r,name:"Affordable Loan"});return{affordablePrincipal:d,totalPurchasePrice:u,downPayment:r,monthlyPayment:m.paymentAmount(),totalInterest:m.totalInterest(),loan:m}}}e.Ay=s},364:function(t,e,a){function n(t){return{en:"en-US",es:"es-ES"}[t]||"en-US"}function i(t,e=2,a="en-US"){return new Intl.NumberFormat(a,{minimumFractionDigits:e,maximumFractionDigits:e}).format(t)}function s(t,e="USD",a="en-US"){return new Intl.NumberFormat(a,{style:"currency",currency:e}).format(t)}function r(t,e=null,a="en-US"){const n=t instanceof Date?t:new Date(t);if(!e)return new Intl.DateTimeFormat(a).format(n);e=e||function(t){return{"en-US":"MM/DD/YYYY","es-ES":"DD/MM/YYYY"}[t]||"MM/DD/YYYY"}(a);const i=String(n.getMonth()+1).padStart(2,"0"),s=String(n.getDate()).padStart(2,"0"),r=n.getFullYear();let o=e;return o=o.replace("MM",i),o=o.replace("DD",s),o=o.replace("YYYY",r),o}function o(t,e=2){return`${Number(100*t).toFixed(e)}%`}function l(t){const e=Math.floor(t/12),a=t%12;let n="";return e>0&&(n+=`${e} year${1!==e?"s":""}`),a>0&&(n.length>0&&(n+=" and "),n+=`${a} month${1!==a?"s":""}`),n}a.d(e,{Ee:function(){return o},Vb:function(){return n},Yq:function(){return r},ZV:function(){return i},a3:function(){return l},vv:function(){return s}})},408:function(t,e,a){var n=a(663),i=a(719);e.A=class{constructor(t={}){this.container=t.container||document.getElementById("guidance-container"),this.language=t.language||"en",this.calculatorForm=t.calculatorForm,this.resultsDisplay=t.resultsDisplay,this.init()}init(){this.render(),this.bindEvents(),this.initializeTooltips()}render(){if(!this.container)return;const t=t=>(0,n.sC)(t,this.language),e=`\n      <div class="guidance-manager">\n        <button id="show-tutorial" class="guidance-button" data-tooltip="${t("tooltips.startTutorial")}" data-tooltip-position="bottom">\n          <span class="guidance-icon">\ud83d\udd0d</span>\n          <span class="guidance-text">${t("guidance.tutorial")}</span>\n        </button>\n        <button id="show-guidance" class="guidance-button" data-tooltip="${t("tooltips.showGuidance")}" data-tooltip-position="bottom">\n          <span class="guidance-icon">\ud83d\udca1</span>\n          <span class="guidance-text">${t("guidance.help")}</span>\n        </button>\n      </div>\n    `;this.container.innerHTML=e}bindEvents(){if(!this.container)return;const t=this.container.querySelector("#show-tutorial");t&&t.addEventListener("click",()=>this.startTutorial());const e=this.container.querySelector("#show-guidance");e&&e.addEventListener("click",()=>this.showGuidance()),(0,i.Dc)(this.container)}initializeTooltips(){(0,i.Dc)(document),this.calculatorForm&&this.calculatorForm.container&&this.addFormTooltips(),this.resultsDisplay&&this.resultsDisplay.container&&this.addResultsTooltips()}addFormTooltips(){const t=t=>(0,n.sC)(t,this.language),e=this.calculatorForm.container,a=(a,n,i="top")=>{const s=e.querySelector(`label[for="${a}"]`);if(s&&!s.querySelector(".info-icon")){const e=document.createElement("span");e.className="info-icon",e.textContent="?",e.setAttribute("data-tooltip",t(n)),e.setAttribute("data-tooltip-position",i),s.appendChild(e)}};a("loan-type","tooltips.loanType"),a("principal","tooltips.loanAmount"),a("interestRate","tooltips.interestRate"),a("term","tooltips.loanTerm"),a("downPayment","tooltips.downPayment"),a("additionalPayment","tooltips.additionalPayment"),a("paymentFrequency","tooltips.paymentFrequency"),a("startDate","tooltips.startDate"),(0,i.Dc)(e)}addResultsTooltips(){const t=t=>(0,n.sC)(t,this.language),e=this.resultsDisplay.container,a=(a,n,i="top")=>{const s=e.querySelector(a);if(s&&!s.querySelector(".info-icon")){const e=document.createElement("span");e.className="info-icon",e.textContent="?",e.setAttribute("data-tooltip",t(n)),e.setAttribute("data-tooltip-position",i),s.appendChild(e)}};a(".monthly-payment-label","tooltips.monthlyPayment"),a(".total-payment-label","tooltips.totalPayment"),a(".total-interest-label","tooltips.totalInterest"),a(".payoff-date-label","tooltips.payoffDate"),a(".interest-savings-label","tooltips.interestSavings"),(0,i.Dc)(e)}startTutorial(){const t=t=>(0,n.sC)(t,this.language),e=[{selector:"#loan-type",title:t("tutorial.loanTypeTitle"),content:t("tutorial.loanTypeContent"),position:"bottom"},{selector:"#principal",title:t("tutorial.loanAmountTitle"),content:t("tutorial.loanAmountContent"),position:"bottom"},{selector:"#interestRate",title:t("tutorial.interestRateTitle"),content:t("tutorial.interestRateContent"),position:"bottom"},{selector:"#term",title:t("tutorial.loanTermTitle"),content:t("tutorial.loanTermContent"),position:"bottom"},{selector:".term-presets",title:t("tutorial.termPresetsTitle"),content:t("tutorial.termPresetsContent"),position:"top"},{selector:"#additionalPayment",title:t("tutorial.additionalPaymentTitle"),content:t("tutorial.additionalPaymentContent"),position:"top"},{selector:"#calculate-button",title:t("tutorial.calculateTitle"),content:t("tutorial.calculateContent"),position:"top"},{selector:".results-summary",title:t("tutorial.resultsTitle"),content:t("tutorial.resultsContent"),position:"bottom"},{selector:"#amortization-table-container",title:t("tutorial.amortizationTitle"),content:t("tutorial.amortizationContent"),position:"top"},{selector:"#charts-container",title:t("tutorial.chartsTitle"),content:t("tutorial.chartsContent"),position:"top"}];(0,i.Xo)(e,()=>{this.showGuidancePanel(t("tutorial.completedTitle"),t("tutorial.completedContent"),"tutorial-completed")})}showGuidance(){const t=t=>(0,n.sC)(t,this.language),e=`\n      <div class="guidance-sections">\n        <div class="guidance-section">\n          <h4>${t("guidance.interpretingResultsTitle")}</h4>\n          <p>${t("guidance.interpretingResultsContent")}</p>\n        </div>\n        \n        <div class="guidance-section">\n          <h4>${t("guidance.affordabilityTitle")}</h4>\n          <p>${t("guidance.affordabilityContent")}</p>\n          <ul>\n            <li>${t("guidance.affordabilityTip1")}</li>\n            <li>${t("guidance.affordabilityTip2")}</li>\n            <li>${t("guidance.affordabilityTip3")}</li>\n          </ul>\n        </div>\n        \n        <div class="guidance-section">\n          <h4>${t("guidance.additionalPaymentsTitle")}</h4>\n          <p>${t("guidance.additionalPaymentsContent")}</p>\n        </div>\n        \n        <div class="guidance-section">\n          <h4>${t("guidance.refinanceTitle")}</h4>\n          <p>${t("guidance.refinanceContent")}</p>\n          <ul>\n            <li>${t("guidance.refinanceTip1")}</li>\n            <li>${t("guidance.refinanceTip2")}</li>\n            <li>${t("guidance.refinanceTip3")}</li>\n          </ul>\n        </div>\n      </div>\n    `;this.showGuidancePanel(t("guidance.title"),e,"loan-guidance")}showGuidancePanel(t,e,a){let n=document.getElementById("guidance-panels-container");n||(n=document.createElement("div"),n.id="guidance-panels-container",document.body.appendChild(n)),(0,i.ZB)(n,t,e,a)}updateLanguage(t){this.language!==t&&(this.language=t,this.render(),this.bindEvents(),this.initializeTooltips())}}},455:function(t,e,a){var n=a(364),i=a(741);e.A=class{constructor(t={}){this.container=t.container||(t.containerId?document.getElementById(t.containerId):null)||document.getElementById("results-display"),this.formatters={currency:n.vv,percentage:n.Ee,number:n.ZV,date:n.Yq,duration:n.a3,...t.formatters},this.onSave=t.onSave||null,this.init()}init(){this.container&&(this.container.innerHTML='\n      <div class="results-display">\n        <div class="results-header">\n          <h2>Loan Summary</h2>\n          <div class="results-actions">\n            <button class="btn-save" id="save-calculation">Save</button>\n            <button class="btn-export" id="export-calculation">Export</button>\n          </div>\n        </div>\n        <div class="results-content">\n          <div class="results-summary" id="results-summary"></div>\n          <div class="results-breakdown" id="results-breakdown"></div>\n          <div class="results-charts" id="charts-container"></div>\n        </div>\n      </div>\n    ',this.charts=new i.default({container:this.container.querySelector("#charts-container")}),this._initEventListeners())}_initEventListeners(){const t=this.container.querySelector("#save-calculation"),e=this.container.querySelector("#export-calculation");t&&t.addEventListener("click",()=>{"function"===typeof this.onSave&&this._currentLoan&&this._currentAmortizationSchedule&&this.onSave(this._currentLoan,this._currentAmortizationSchedule)}),e&&e.addEventListener("click",()=>{})}render(t){if(!this.container||!t||!t.loan)return;const{loan:e,amortizationSchedule:a,inflationAdjusted:n,comparisonScenarios:i}=t;this._currentLoan=e,this._currentAmortizationSchedule=a;const s={loanAmount:e.totalLoanAmount,paymentAmount:e.paymentAmount,totalInterest:a?a.totalInterest:e.totalInterest,totalPayment:a?a.totalPayment:e.paymentAmount*e.numberOfPayments,term:e.term,interestRate:e.interestRate,paymentFrequency:e.paymentFrequency,payoffDate:a?a.payoffDate:e.payoffDate,numberOfPayments:e.numberOfPayments,inflationRate:e.inflationRate,inflationAdjusted:n?{totalPayment:n.summary.totalInflationAdjustedPayment,totalInterest:n.summary.totalInflationAdjustedInterest,savingsFromInflation:n.summary.savingsFromInflation}:null},r={principal:e.totalLoanAmount,interest:s.totalInterest,total:s.totalPayment,interestRatio:s.totalInterest/s.totalPayment,principalRatio:e.totalLoanAmount/s.totalPayment};if(this.displaySummary(s),this.displayPaymentBreakdown(r),this.charts&&a&&(this.charts.clear(),this.charts.renderPrincipalVsInterestChart({loan:e,amortizationSchedule:a}),this.charts.renderPaymentBreakdownPieChart({loan:e,amortizationSchedule:a}),i&&i.length>0)){const t=[{id:"current",name:e.name||"Current Calculation",loan:e,amortizationSchedule:a}];i.forEach(e=>{"current"!==e.id&&t.push(e)}),t.length>=2&&this.charts.renderComparisonChart(t)}this.container.style.display="block"}displaySummary(t){const e=this.container.querySelector("#results-summary");if(!e)return;const a=this.formatters.currency(t.loanAmount),n=this.formatters.currency(t.paymentAmount),i=this.formatters.currency(t.totalInterest),s=this.formatters.currency(t.totalPayment),r=this.formatters.duration(t.term),o=this.formatters.percentage(t.interestRate/100),l=this.formatters.date(t.payoffDate),c=t.numberOfPayments;let d="";if(t.inflationAdjusted&&t.inflationRate>0){const e={inflationRate:this.formatters.percentage(t.inflationRate/100),totalAdjustedPayment:this.formatters.currency(t.inflationAdjusted.totalPayment),savingsFromInflation:this.formatters.currency(t.inflationAdjusted.savingsFromInflation),savingsPercentage:this.formatters.percentage(t.inflationAdjusted.savingsFromInflation/t.totalPayment)};d=`\n        <div class="inflation-section">\n          <h3>Inflation-Adjusted Values (${e.inflationRate} inflation)</h3>\n          <div class="summary-grid">\n            <div class="summary-item">\n              <div class="summary-label">Inflation-Adjusted Total Payment</div>\n              <div class="summary-value">${e.totalAdjustedPayment}</div>\n            </div>\n            <div class="summary-item highlight">\n              <div class="summary-label">Real Savings Due to Inflation</div>\n              <div class="summary-value">${e.savingsFromInflation} (${e.savingsPercentage})</div>\n            </div>\n          </div>\n        </div>\n      `}const u=`\n      <div class="summary-grid">\n        <div class="summary-item">\n          <div class="summary-label">${{monthly:"Monthly","bi-weekly":"Bi-Weekly",weekly:"Weekly"}[t.paymentFrequency]||"Monthly"} Payment</div>\n          <div class="summary-value highlight">${n}</div>\n        </div>\n        <div class="summary-item">\n          <div class="summary-label">Loan Amount</div>\n          <div class="summary-value">${a}</div>\n        </div>\n        <div class="summary-item">\n          <div class="summary-label">Total Interest</div>\n          <div class="summary-value">${i}</div>\n        </div>\n        <div class="summary-item">\n          <div class="summary-label">Total Payment</div>\n          <div class="summary-value">${s}</div>\n        </div>\n        <div class="summary-item">\n          <div class="summary-label">Loan Term</div>\n          <div class="summary-value">${r}</div>\n        </div>\n        <div class="summary-item">\n          <div class="summary-label">Interest Rate</div>\n          <div class="summary-value">${o}</div>\n        </div>\n        <div class="summary-item">\n          <div class="summary-label">Number of Payments</div>\n          <div class="summary-value">${c}</div>\n        </div>\n        <div class="summary-item">\n          <div class="summary-label">Payoff Date</div>\n          <div class="summary-value">${l}</div>\n        </div>\n      </div>\n      ${d}\n    `;e.innerHTML=u,this._addInterestRateIndicator(t.interestRate)}_addInterestRateIndicator(t){const e=this.container.querySelector(".summary-item:nth-child(6) .summary-value");e&&(e.classList.remove("rate-low","rate-medium","rate-high"),t<4?(e.classList.add("rate-low"),e.setAttribute("title","This is a low interest rate")):t<7?(e.classList.add("rate-medium"),e.setAttribute("title","This is an average interest rate")):(e.classList.add("rate-high"),e.setAttribute("title","This is a high interest rate")))}displayPaymentBreakdown(t){const e=this.container.querySelector("#results-breakdown");if(!e)return;const a=this.formatters.currency(t.principal),n=this.formatters.currency(t.interest),i=this.formatters.currency(t.total),s=this.formatters.percentage(t.interestRatio),r=this.formatters.percentage(t.principalRatio),o=`\n      <h3>Payment Breakdown</h3>\n      <div class="breakdown-chart">\n        <div class="breakdown-bar">\n          <div class="breakdown-principal" style="width: ${Math.round(100*t.principalRatio)}%" title="Principal: ${r}">\n            <span class="breakdown-label">Principal</span>\n          </div>\n          <div class="breakdown-interest" style="width: ${Math.round(100*t.interestRatio)}%" title="Interest: ${s}">\n            <span class="breakdown-label">Interest</span>\n          </div>\n        </div>\n        <div class="breakdown-legend">\n          <div class="legend-item">\n            <div class="legend-color principal-color"></div>\n            <div class="legend-label">Principal: ${a} (${r})</div>\n          </div>\n          <div class="legend-item">\n            <div class="legend-color interest-color"></div>\n            <div class="legend-label">Interest: ${n} (${s})</div>\n          </div>\n        </div>\n      </div>\n      <div class="breakdown-total">\n        <span>Total Payment: ${i}</span>\n      </div>\n    `;e.innerHTML=o}clear(){if(!this.container)return;const t=this.container.querySelector("#results-summary"),e=this.container.querySelector("#results-breakdown");t&&(t.innerHTML=""),e&&(e.innerHTML=""),this.charts&&this.charts.clear(),this.container.style.display="none"}update(t){this.render(t)}updateResults(t,e,a=null){this.render({loan:t,amortizationSchedule:e,inflationAdjusted:a})}}},478:function(t,e,a){a.r(e),a.d(e,{AmortizationSchedule:function(){return n},Payment:function(){return i}});class n{constructor(t,e=!0){this.loan=t,this.payments=[],this.isGenerating=!1,this.generationProgress=0,e&&this.generateSchedule()}async generateScheduleAsync(t={}){const e=!1!==t.includeAdditionalPayments,a=t.onProgress||(()=>{}),n=t.timeout||5e3,s=t.batchSize||50;this.isGenerating=!0,this.generationProgress=0;try{this.payments=[];const t=this.loan.totalLoanAmount();if(t<=0)throw new Error("Loan amount must be greater than zero.");if(t>1e8)throw new Error("Loan amount is too large. Please enter a reasonable loan amount.");const r=this.loan.interestRate;if(r<0||r>50)throw new Error("Interest rate must be between 0% and 50%.");const o=this.loan.term;if(o<=0||o>600)throw new Error("Loan term must be between 1 and 600 months.");const l=this.loan.totalLoanAmount(),c=this.loan.periodicInterestRate(),d=this.loan.paymentAmount(),u=e?this.loan.additionalPayment:0,m=2*this.loan.numberOfPayments();if(isNaN(c)||c<0)throw new Error("Invalid interest rate calculation. Please check your interest rate.");if(isNaN(d)||d<=0)throw new Error("Invalid payment calculation. Please check your loan parameters.");if(d<=l*c)throw new Error("Monthly payment is too low to cover interest. Please increase the payment amount or reduce the loan amount.");let h=l,p=1;const y=new Date(this.loan.startDate),g=this.getPaymentInterval(),f=Date.now();for(;h>0&&p<=m;){if(Date.now()-f>n)throw new Error(`Calculation timeout after ${n}ms. The loan parameters may be invalid.`);const t=h*c,e=Math.min(d+u,h+t),r=e-t;h=Math.max(0,h-r);const o=new i(p,new Date(y),e,r,t,h);this.payments.push(o);const l=Math.min(this.loan.numberOfPayments(),m);this.generationProgress=Math.min(95,p/l*100),p%s===0&&(a(this.generationProgress,`Processing payment ${p}...`),await new Promise(t=>setTimeout(t,0))),p++,this.advanceDate(y,g),h>0&&h<.01&&(h=0)}if(p>m&&h>0)throw new Error("Maximum payment limit reached. Please check your loan parameters.");return this.isGenerating=!1,this.generationProgress=100,a(100,"Complete"),this.payments}catch(r){throw this.isGenerating=!1,this.generationProgress=0,r}}generateSchedule(t={}){const e=!1!==t.includeAdditionalPayments;if(this.payments=[],this.loan.totalLoanAmount()<=0)return this.payments;const a=this.loan.totalLoanAmount(),n=this.loan.periodicInterestRate(),s=this.loan.paymentAmount(),r=e?this.loan.additionalPayment:0;let o=a,l=1;const c=new Date(this.loan.startDate),d=this.getPaymentInterval();for(;o>0;){const t=o*n,e=Math.min(s+r,o+t),a=e-t;o=Math.max(0,o-a);const u=new i(l,new Date(c),e,a,t,o);if(this.payments.push(u),l++,this.advanceDate(c,d),l>2*this.loan.numberOfPayments())break;o>0&&o<.01&&(o=0)}return this.payments}getPaymentInterval(){switch(this.loan.paymentFrequency){case"weekly":return{days:7,type:"days"};case"bi-weekly":return{days:14,type:"days"};default:return{days:1,type:"months"}}}advanceDate(t,e){"days"===e.type?t.setDate(t.getDate()+e.days):"months"===e.type&&t.setMonth(t.getMonth()+e.days)}totalInterest(){return this.payments.reduce((t,e)=>t+e.interest,0)}totalPayment(){return this.payments.reduce((t,e)=>t+e.amount,0)}payoffDate(){return 0===this.payments.length?new Date(this.loan.startDate):new Date(this.payments[this.payments.length-1].date)}toJSON(){return{loanId:this.loan.id,payments:this.payments.map(t=>t.toJSON())}}static fromJSON(t,e){if(!t||!t.payments||!Array.isArray(t.payments))return new n(e);const a=new n(e);return a.payments=t.payments.map(t=>i.fromJSON(t)),a}}class i{constructor(t,e,a,n,i,s){this.number=t,this.date=e,this.amount=a,this.principal=n,this.interest=i,this.balance=s}month(){return this.date.getMonth()+1}year(){return this.date.getFullYear()}cumulativePrincipal(){return this.principal}cumulativeInterest(){return this.interest}toJSON(){return{number:this.number,date:this.date.toISOString(),amount:this.amount,principal:this.principal,interest:this.interest,balance:this.balance}}static fromJSON(t){return t?new i(t.number,new Date(t.date),t.amount,t.principal,t.interest,t.balance):null}}},563:function(t,e,a){a.d(e,{A:function(){return p}});var n=a(287);function i(t){return!isNaN(parseFloat(t))&&isFinite(t)}function s(t){return i(t)&&parseFloat(t)>0}function r(t,e,a){return i(t)&&parseFloat(t)>=e&&parseFloat(t)<=a}function o(t){return r(t,0,100)}function l(t){return r(t,0,20)}function c(t){return i(t)&&Number.isInteger(parseFloat(t))&&parseFloat(t)>0}var d=a(364),u=a(663),m=a(719);var h=class{constructor(t={}){this.container=t.container||document.getElementById("market-rates-container"),this.language=t.language||"en",this.currentLoanType=t.loanType||"mortgage",this.currentRate=t.currentRate||0,this.onRateSelect=t.onRateSelect||(()=>{}),this.marketRatesData={mortgage:{average:6.75,min:5.85,max:7.65,trend:"stable",lastUpdated:new Date("2025-07-15")},auto:{average:7.25,min:6.5,max:9.75,trend:"up",lastUpdated:new Date("2025-07-16")},personal:{average:11.5,min:8.75,max:17.99,trend:"up",lastUpdated:new Date("2025-07-16")},student:{average:5.5,min:4.99,max:7.25,trend:"down",lastUpdated:new Date("2025-07-14")}},this.init()}init(){this.render(),this.bindEvents()}render(){if(!this.container)return;const t=t=>(0,u.sC)(t,this.language),e=this.marketRatesData[this.currentLoanType]||this.marketRatesData.mortgage,a=d.Vb(this.language),n=e.lastUpdated.toLocaleDateString(a,{year:"numeric",month:"short",day:"numeric"}),i=this.getTrendIcon(e.trend),s=`\n      <div class="market-rates">\n        <div class="market-rates-header">\n          <h3>${t("marketRates.title")}</h3>\n          <div class="market-rates-disclaimer">${t("marketRates.disclaimer")}</div>\n        </div>\n        \n        <div class="market-rates-content">\n          <div class="market-rates-summary">\n            <div class="market-rates-average">\n              <span class="market-rates-label">${t("marketRates.averageRate")}</span>\n              <span class="market-rates-value">${e.average.toFixed(2)}%</span>\n              <span class="market-rates-trend ${e.trend}">${i}</span>\n            </div>\n            <div class="market-rates-range">\n              <span class="market-rates-label">${t("marketRates.rateRange")}</span>\n              <span class="market-rates-value">${e.min.toFixed(2)}% - ${e.max.toFixed(2)}%</span>\n            </div>\n          </div>\n          \n          <div class="market-rates-comparison">\n            <div class="market-rates-your-rate">\n              <span class="market-rates-label">${t("marketRates.yourRate")}</span>\n              <span class="market-rates-value ${this.getRateComparisonClass(this.currentRate,e.average)}">\n                ${this.currentRate.toFixed(2)}%\n              </span>\n            </div>\n            <div class="market-rates-difference">\n              <span class="market-rates-label">${t("marketRates.difference")}</span>\n              <span class="market-rates-value ${this.getRateComparisonClass(this.currentRate,e.average)}">\n                ${this.formatRateDifference(this.currentRate,e.average)}\n              </span>\n            </div>\n          </div>\n          \n          <div class="market-rates-actions">\n            <button id="use-average-rate" class="market-rates-button">\n              ${t("marketRates.useAverageRate")}\n            </button>\n          </div>\n          \n          <div class="market-rates-footer">\n            <span class="market-rates-updated">${t("marketRates.lastUpdated")}: ${n}</span>\n          </div>\n        </div>\n      </div>\n    `;this.container.innerHTML=s}bindEvents(){if(!this.container)return;const t=this.container.querySelector("#use-average-rate");t&&t.addEventListener("click",()=>{const t=this.marketRatesData[this.currentLoanType]||this.marketRatesData.mortgage;this.onRateSelect(t.average)})}getTrendIcon(t){switch(t){case"up":return'<span class="trend-icon trend-up" aria-hidden="true">\u2191</span>';case"down":return'<span class="trend-icon trend-down" aria-hidden="true">\u2193</span>';default:return'<span class="trend-icon trend-stable" aria-hidden="true">\u2192</span>'}}getRateComparisonClass(t,e){const a=t-e;return Math.abs(a)<=.25?"rate-average":a<0?"rate-below":"rate-above"}formatRateDifference(t,e){const a=t-e,n=t=>(0,u.sC)(t,this.language);return Math.abs(a)<=.1?n("marketRates.sameAsAverage"):a<0?`${Math.abs(a).toFixed(2)}% ${n("marketRates.belowAverage")}`:`${a.toFixed(2)}% ${n("marketRates.aboveAverage")}`}updateLoanType(t){n.fx[t]&&this.currentLoanType!==t&&(this.currentLoanType=t,this.render(),this.bindEvents())}updateCurrentRate(t){this.currentRate!==t&&(this.currentRate=t,this.render(),this.bindEvents())}updateLanguage(t){this.language!==t&&(this.language=t,this.render(),this.bindEvents())}};var p=class{constructor(t={}){this.container=t.container||document.getElementById("calculator-form-container"),this.onCalculate=t.onCalculate||(()=>{}),this.validators={principal:s,interestRate:o,term:c,downPayment:i,additionalPayment:i,inflationRate:l,...t.validators},this.language=t.language||"en",this.locale=d.Vb(this.language),this.formData=n.Ay.createDefault("mortgage").toJSON(),void 0===this.formData.inflationRate&&(this.formData.inflationRate=2.5),this.marketRatesComponent=null,this.init()}init(){this.render(),this.bindEvents(),this.initMarketRates(),this.handleCalculate()}initMarketRates(){const t=this.container.querySelector("#market-rates-container");t&&(this.marketRatesComponent=new h({container:t,language:this.language,loanType:this.formData.type,currentRate:this.formData.interestRate,onRateSelect:t=>{const e=this.container.querySelector("#interestRate"),a=this.container.querySelector("#interestRate-slider");e&&a&&(e.value=t,a.value=t,this.handleCalculate())}}))}render(){if(!this.container)return;const t=t=>(0,u.sC)(t,this.language),e=`\n      <div class="calculator-form">\n        <h2>${t("form.title")}</h2>\n        <form id="loan-calculator-form">\n          \x3c!-- Loan Type Selector --\x3e\n          <div class="form-group">\n            <label for="loan-type" class="form-label">\n              ${t("form.loanType")}\n              <span class="info-icon" data-tooltip="${t("tooltips.loanType")}" data-tooltip-position="top">?</span>\n            </label>\n            <select id="loan-type" class="form-select" name="type">\n              ${Object.entries(n.fx).map(([e,a])=>{const n=`form.${e}`,i=t(n)!==n?t(n):a.description;return`<option value="${e}" ${this.formData.type===e?"selected":""}>${i}</option>`}).join("")}\n            </select>\n          </div>\n          \n          \x3c!-- Loan Amount --\x3e\n          <div class="form-group">\n            <label for="principal" class="form-label">\n              ${t("form.loanAmount")} (${this.formData.currency||"USD"})\n            </label>\n            <input \n              type="number" \n              id="principal" \n              class="form-input" \n              name="principal" \n              value="${this.formData.principal}" \n              min="${n.fx[this.formData.type].minAmount}" \n              max="${n.fx[this.formData.type].maxAmount}" \n              step="1000"\n            >\n            <div class="range-container">\n              <input \n                type="range" \n                id="principal-slider" \n                class="form-slider" \n                min="${n.fx[this.formData.type].minAmount}" \n                max="${n.fx[this.formData.type].maxAmount}" \n                step="1000" \n                value="${this.formData.principal}"\n              >\n              <div class="range-values">\n                <span>${d.vv(n.fx[this.formData.type].minAmount,this.formData.currency||"USD",this.locale)}</span>\n                <span>${d.vv(n.fx[this.formData.type].maxAmount,this.formData.currency||"USD",this.locale)}</span>\n              </div>\n            </div>\n            <div class="invalid-feedback" id="principal-error"></div>\n          </div>\n          \n          \x3c!-- Down Payment --\x3e\n          <div class="form-group">\n            <label for="downPayment" class="form-label">${t("form.downPayment")} (${this.formData.currency||"USD"})</label>\n            <input \n              type="number" \n              id="downPayment" \n              class="form-input" \n              name="downPayment" \n              value="${this.formData.downPayment}" \n              min="0" \n              max="${this.formData.principal}" \n              step="1000"\n            >\n            <div class="range-container">\n              <input \n                type="range" \n                id="downPayment-slider" \n                class="form-slider" \n                min="0" \n                max="${this.formData.principal}" \n                step="1000" \n                value="${this.formData.downPayment}"\n              >\n              <div class="range-values">\n                <span>${d.vv(0,this.formData.currency||"USD",this.locale)}</span>\n                <span>${d.vv(this.formData.principal,this.formData.currency||"USD",this.locale)}</span>\n              </div>\n            </div>\n            <div class="invalid-feedback" id="downPayment-error"></div>\n          </div>\n          \n          \x3c!-- Interest Rate --\x3e\n          <div class="form-group">\n            <label for="interestRate" class="form-label">${t("form.interestRate")} (%)</label>\n            <input \n              type="number" \n              id="interestRate" \n              class="form-input" \n              name="interestRate" \n              value="${this.formData.interestRate}" \n              min="0" \n              max="30" \n              step="0.125"\n            >\n            <div class="range-container">\n              <input \n                type="range" \n                id="interestRate-slider" \n                class="form-slider" \n                min="0" \n                max="30" \n                step="0.125" \n                value="${this.formData.interestRate}"\n              >\n              <div class="range-values">\n                <span>0%</span>\n                <span>30%</span>\n              </div>\n            </div>\n            <div class="invalid-feedback" id="interestRate-error"></div>\n          </div>\n          \n          \x3c!-- Market Rates --\x3e\n          <div id="market-rates-container" class="market-rates-container"></div>\n          \n          \x3c!-- Loan Term --\x3e\n          <div class="form-group">\n            <label for="term" class="form-label">${t("form.loanTerm")} (${t("form.months")})</label>\n            <input \n              type="number" \n              id="term" \n              class="form-input" \n              name="term" \n              value="${this.formData.term}" \n              min="1" \n              max="600" \n              step="1"\n            >\n            <div class="range-container">\n              <input \n                type="range" \n                id="term-slider" \n                class="form-slider" \n                min="1" \n                max="600" \n                step="1" \n                value="${this.formData.term}"\n              >\n              <div class="range-values">\n                <span>1 ${t("form.months")}</span>\n                <span>600 ${t("form.months")}</span>\n              </div>\n            </div>\n            <div class="term-presets">\n              <button type="button" class="term-preset" data-term="60">5 ${t("form.years")}</button>\n              <button type="button" class="term-preset" data-term="180">15 ${t("form.years")}</button>\n              <button type="button" class="term-preset" data-term="360">30 ${t("form.years")}</button>\n            </div>\n            <div class="invalid-feedback" id="term-error"></div>\n          </div>\n          \n          \x3c!-- Payment Frequency --\x3e\n          <div class="form-group">\n            <label for="paymentFrequency" class="form-label">${t("form.paymentFrequency")}</label>\n            <select id="paymentFrequency" class="form-select" name="paymentFrequency">\n              ${Object.entries(n._2).map(([e,a])=>{const n=`form.${e}`,i=t(n)!==n?t(n):a.description;return`<option value="${e}" ${this.formData.paymentFrequency===e?"selected":""}>${i}</option>`}).join("")}\n            </select>\n          </div>\n          \n          \x3c!-- Start Date --\x3e\n          <div class="form-group">\n            <label for="startDate" class="form-label">${t("form.startDate")}</label>\n            <input \n              type="date" \n              id="startDate" \n              class="form-input" \n              name="startDate" \n              value="${new Date(this.formData.startDate).toISOString().split("T")[0]}"\n            >\n            <div class="invalid-feedback" id="startDate-error"></div>\n          </div>\n          \n          \x3c!-- Additional Payment --\x3e\n          <div class="form-group">\n            <label for="additionalPayment" class="form-label">${t("form.additionalPayment")} (${this.formData.currency||"USD"})</label>\n            <input \n              type="number" \n              id="additionalPayment" \n              class="form-input" \n              name="additionalPayment" \n              value="${this.formData.additionalPayment}" \n              min="0" \n              step="10"\n            >\n            <div class="invalid-feedback" id="additionalPayment-error"></div>\n          </div>\n          \n          \x3c!-- Inflation Rate --\x3e\n          <div class="form-group">\n            <label for="inflationRate" class="form-label">\n              ${t("form.inflationRate")||"Inflation Rate"} (%)\n              <span class="info-icon" data-tooltip="${t("tooltips.inflationRate")||"Annual inflation rate used to calculate the real value of future payments."}" data-tooltip-position="top">?</span>\n            </label>\n            <input \n              type="number" \n              id="inflationRate" \n              class="form-input" \n              name="inflationRate" \n              value="${this.formData.inflationRate||2.5}" \n              min="0" \n              max="20" \n              step="0.1"\n            >\n            <div class="range-container">\n              <input \n                type="range" \n                id="inflationRate-slider" \n                class="form-slider" \n                min="0" \n                max="20" \n                step="0.1" \n                value="${this.formData.inflationRate||2.5}"\n              >\n              <div class="range-values">\n                <span>0%</span>\n                <span>20%</span>\n              </div>\n            </div>\n            <div class="invalid-feedback" id="inflationRate-error"></div>\n          </div>\n          \n          \x3c!-- Calculate Button --\x3e\n          <div class="form-group">\n            <button type="submit" class="form-button" id="calculate-button">${t("form.calculate")}</button>\n            <button type="button" class="form-button" id="reset-button">${t("form.reset")}</button>\n          </div>\n        </form>\n      </div>\n    `;this.container.innerHTML=e}bindEvents(){if(!this.container)return;const t=this.container.querySelector("#loan-calculator-form");if(!t)return;t.addEventListener("submit",t=>{t.preventDefault(),this.handleCalculate()});const e=this.container.querySelector("#reset-button");e&&e.addEventListener("click",()=>this.reset());const a=this.container.querySelector("#loan-type");a&&a.addEventListener("change",t=>{const e=t.target.value;this.updateLoanTypeParameters(e)}),this.bindSliderInputSync("principal"),this.bindSliderInputSync("downPayment"),this.bindSliderInputSync("interestRate"),this.bindSliderInputSync("term"),this.bindSliderInputSync("inflationRate");this.container.querySelectorAll(".term-preset").forEach(t=>{t.addEventListener("click",t=>{const e=parseInt(t.target.dataset.term,10),a=this.container.querySelector("#term"),n=this.container.querySelector("#term-slider");a&&n&&(a.value=e,n.value=e,this.validateField("term",e),this.handleCalculate())})});t.querySelectorAll("input, select").forEach(t=>{t.addEventListener("input",t=>{const e=t.target.name||t.target.id,{value:a}=t.target;if(this.validateField(e,a),"principal"===e){const t=this.container.querySelector("#downPayment"),e=this.container.querySelector("#downPayment-slider");if(t&&e){const n=parseFloat(a);if(t.max=n,e.max=n,parseFloat(t.value)>n){t.value=n,e.value=n;const a=new Event("input");t.dispatchEvent(a)}}}this.handleCalculate()})}),(0,m.Dc)(this.container)}bindSliderInputSync(t){const e=this.container.querySelector(`#${t}`),a=this.container.querySelector(`#${t}-slider`);e&&a&&(a.addEventListener("input",a=>{e.value=a.target.value,this.validateField(t,a.target.value)}),e.addEventListener("input",t=>{a.value=t.target.value}))}updateLoanTypeParameters(t){if(!n.fx[t])return;const e=n.fx[t],a=this.container.querySelector("#principal"),i=this.container.querySelector("#principal-slider");if(a&&i){a.min=e.minAmount,a.max=e.maxAmount,i.min=e.minAmount,i.max=e.maxAmount;const t=i.parentElement.querySelector(".range-values");t&&(t.innerHTML=`\n          <span>${d.vv(e.minAmount,this.formData.currency||"USD",this.locale)}</span>\n          <span>${d.vv(e.maxAmount,this.formData.currency||"USD",this.locale)}</span>\n        `);const n=parseFloat(a.value);n<e.minAmount?(a.value=e.minAmount,i.value=e.minAmount):n>e.maxAmount&&(a.value=e.maxAmount,i.value=e.maxAmount)}const s=this.container.querySelector("#term"),r=this.container.querySelector("#term-slider");s&&r&&(s.value=e.defaultTerm,r.value=e.defaultTerm);const o=this.container.querySelector("#interestRate"),l=this.container.querySelector("#interestRate-slider");o&&l&&(o.value=e.defaultRate,l.value=e.defaultRate),this.marketRatesComponent&&(this.marketRatesComponent.updateLoanType(t),this.marketRatesComponent.updateCurrentRate(e.defaultRate)),this.handleCalculate()}validateField(t,e){const a=this.validators[t];if(!a)return!0;let n=!0,i="";try{n=a(e),n||(i=this.getFieldErrorMessage(t,e))}catch(o){n=!1,i=`Validation error: ${o.message}`}const s=this.container.querySelector(`#${t}`),r=this.container.querySelector(`#${t}-error`);return s&&r&&(n?(s.classList.remove("is-invalid"),r.textContent=""):(s.classList.add("is-invalid"),r.textContent=i)),n}getFieldErrorMessage(t,e){const a=this.container.querySelector(`#${t}`),n=a?parseFloat(a.min):null,i=a?parseFloat(a.max):null,s=parseFloat(e);switch(t){case"principal":return isNaN(s)||s<=0?"Please enter a valid loan amount greater than $0":null!==n&&s<n?`Loan amount must be at least $${n.toLocaleString()}`:null!==i&&s>i?`Loan amount cannot exceed $${i.toLocaleString()}`:"Please enter a valid loan amount";case"interestRate":return isNaN(s)||s<0?"Interest rate must be 0% or higher":s>50?"Interest rate seems unusually high. Please verify.":"Please enter a valid interest rate";case"term":return isNaN(s)||s<=0?"Loan term must be greater than 0 months":s>600?"Loan term cannot exceed 600 months (50 years)":"Please enter a valid loan term";case"downPayment":return isNaN(s)||s<0?"Down payment cannot be negative":null!==i&&s>i?"Down payment cannot exceed the loan amount":"Please enter a valid down payment";case"additionalPayment":return isNaN(s)||s<0?"Additional payment cannot be negative":"Please enter a valid additional payment amount";case"inflationRate":return isNaN(s)||s<0?"Inflation rate cannot be negative":s>20?"Inflation rate seems unusually high. Please verify.":"Please enter a valid inflation rate";default:return"Please enter a valid value"}}validate(){let t=!0;const e=this.container.querySelector("#loan-calculator-form");if(!e)return!1;return e.querySelectorAll("input, select").forEach(e=>{const a=e.name||e.id,{value:n}=e;if(this.validators[a]){const e=this.validateField(a,n);t=t&&e}}),t}async handleCalculate(){const t=this.getFormData();if(!this.validate())return void this.showFormError("Please correct the errors in the form before calculating.");const e=this.container.querySelector("#calculate-button");e&&(e.disabled=!0,e.textContent="Calculating...");try{const e=n.Ay.fromJSON(t);this.marketRatesComponent&&this.marketRatesComponent.updateCurrentRate(t.interestRate),"function"===typeof this.onCalculate&&await this.onCalculate(e)}catch(a){this.showFormError(`Calculation error: ${a.message||"Unknown error occurred"}`)}finally{e&&(e.disabled=!1,e.textContent="Calculate")}}showFormError(t){const e=this.container.querySelector(".form-error-message");e&&e.remove();const a=document.createElement("div");a.className="form-error-message",a.innerHTML=`\n      <div class="error-content">\n        <span class="error-icon">\u26a0\ufe0f</span>\n        <span class="error-text">${t}</span>\n        <button class="error-close" onclick="this.parentElement.parentElement.remove()">\xd7</button>\n      </div>\n    `;const n=this.container.querySelector("#loan-calculator-form");n&&(n.insertBefore(a,n.firstChild),setTimeout(()=>{a.parentNode&&a.remove()},8e3))}getFormData(){const t=this.container.querySelector("#loan-calculator-form");if(!t)return this.formData;const e={...this.formData};return t.querySelectorAll("input, select").forEach(t=>{const a=t.name||t.id;let{value:n}=t;"number"!==t.type&&"range"!==t.type||(n=parseFloat(n)),"date"===t.type&&(n=new Date(n)),e[a]=n}),this.formData=e,e}setFormData(t){this.formData={...this.formData,...t};const e=this.container.querySelector("#loan-calculator-form");e&&(Object.entries(t).forEach(([t,a])=>{const n=e.querySelector(`#${t}`),i=e.querySelector(`#${t}-slider`);if(n)if("date"===n.type&&a instanceof Date){const[t]=a.toISOString().split("T");n.value=t}else n.value=a;i&&(i.value=a)}),this.validate(),this.handleCalculate())}reset(){const t=this.formData.type||"mortgage",e=n.Ay.createDefault(t),a=this.formData.inflationRate||2.5;this.setFormData({...e.toJSON(),inflationRate:a})}updateLanguage(t){this.language!==t&&(this.language=t,this.locale=d.Vb(t),this.render(),this.bindEvents(),this.initMarketRates(),this.marketRatesComponent&&this.marketRatesComponent.updateLanguage(t))}updateCurrencyFormat(t){this.formData.currency!==t&&(this.formData.currency=t,this.render(),this.bindEvents())}}},663:function(t,e,a){a.d(e,{$:function(){return s},hK:function(){return r},sC:function(){return i}});const n={en:{form:{title:"Loan Calculator",loanAmount:"Loan Amount",interestRate:"Interest Rate",loanTerm:"Loan Term",loanType:"Loan Type",paymentFrequency:"Payment Frequency",downPayment:"Down Payment",additionalPayment:"Additional Payment",startDate:"Start Date",calculate:"Calculate",reset:"Reset",years:"Years",months:"Months",mortgage:"Mortgage",auto:"Auto",personal:"Personal",student:"Student",monthly:"Monthly",biWeekly:"Bi-Weekly",weekly:"Weekly"},marketRates:{title:"Current Market Rates",disclaimer:"Rates are estimates based on national averages and may vary by location, credit score, and other factors.",averageRate:"Average Rate",rateRange:"Rate Range",yourRate:"Your Rate",difference:"Difference",belowAverage:"below average",aboveAverage:"above average",sameAsAverage:"same as average",useAverageRate:"Use Average Rate",lastUpdated:"Last Updated",viewTrends:"View Rate Trends",compareRates:"Compare Your Rate"},glossary:{title:"Financial Terms Glossary",openGlossary:"Open Financial Terms Glossary",close:"Close Glossary",search:"Search glossary terms",searchPlaceholder:"Search for terms...",noResults:"No matching terms found",searchResults:"{count} terms found",opened:"Financial glossary opened",closed:"Financial glossary closed"},results:{monthlyPayment:"Monthly Payment",totalPayment:"Total Payment",totalInterest:"Total Interest",payoffDate:"Payoff Date",interestSavings:"Interest Savings",timeReduction:"Time Reduction",saveCalculation:"Save Calculation",share:"Share",export:"Export",print:"Print"},amortization:{title:"Amortization Schedule",paymentNumber:"Payment #",paymentDate:"Date",payment:"Payment",principal:"Principal",interest:"Interest",balance:"Balance",totalPrincipal:"Total Principal",totalInterest:"Total Interest",filter:"Filter",showAll:"Show All",annual:"Annual Summary",noData:"No data available"},charts:{title:"Payment Charts",principalVsInterest:"Principal vs Interest",paymentBreakdown:"Payment Breakdown",amortizationSchedule:"Amortization Schedule",principal:"Principal",interest:"Interest",balance:"Balance",time:"Time"},savedCalculations:{title:"Saved Calculations",noSavedCalculations:"No saved calculations",load:"Load",delete:"Delete",compare:"Compare",rename:"Rename",confirmDelete:"Are you sure you want to delete this calculation?",enterName:"Enter a name for this calculation",defaultName:"Calculation"},settings:{title:"Settings",theme:"Theme",language:"Language",currency:"Currency",light:"Light",dark:"Dark",dateFormat:"Date Format",numberFormat:"Number Format"},comparison:{title:"Loan Comparison",scenario:"Scenario",difference:"Difference",savings:"Savings"},common:{yes:"Yes",no:"No",ok:"OK",cancel:"Cancel",save:"Save",close:"Close",loading:"Loading...",error:"An error occurred",success:"Success",warning:"Warning",info:"Information"},tooltips:{loanType:"Select the type of loan you need. Different loan types have different default values and limits.",loanAmount:"Enter the total amount you wish to borrow.",interestRate:"The annual interest rate for your loan. Higher rates mean higher monthly payments.",loanTerm:"The length of time to repay the loan. Longer terms mean lower monthly payments but more interest paid overall.",downPayment:"Initial payment made upfront. A larger down payment reduces your loan amount and monthly payments.",additionalPayment:"Extra amount paid each period beyond the required payment. This reduces your loan term and total interest.",paymentFrequency:"How often you make payments. More frequent payments can reduce total interest paid.",startDate:"The date when your loan begins and first payment is due.",monthlyPayment:"The amount you need to pay each period to repay the loan on schedule.",totalPayment:"The total amount you will pay over the life of the loan, including principal and interest.",totalInterest:"The total amount of interest you will pay over the life of the loan.",payoffDate:"The date when your loan will be fully paid off if you make all scheduled payments.",interestSavings:"The amount of interest you save by making additional payments.",startTutorial:"Start a guided tour of the loan calculator features.",showGuidance:"Show guidance for interpreting your loan results.",interpretingResults:"How to interpret your loan calculation results",affordabilityGuidance:"Understanding loan affordability",refinanceGuidance:"When to consider refinancing"},guidance:{title:"Loan Calculator Guidance",help:"Help & Tips",tutorial:"Interactive Tutorial",interpretingResultsTitle:"Interpreting Your Results",interpretingResultsContent:"Your loan calculation results show the monthly payment, total payment, total interest, and payoff date. The monthly payment is the amount you need to pay each period to repay the loan on schedule. The total payment is the sum of all payments over the life of the loan. The total interest is the cost of borrowing the money.",affordabilityTitle:"Understanding Loan Affordability",affordabilityContent:"When determining how much you can afford to borrow, consider the following:",affordabilityTip1:"Your monthly loan payment should ideally be less than 28% of your gross monthly income.",affordabilityTip2:"Consider all other debts and expenses when determining affordability.",affordabilityTip3:"Remember to account for taxes, insurance, and maintenance costs for mortgages.",additionalPaymentsTitle:"Benefits of Additional Payments",additionalPaymentsContent:"Making additional payments can significantly reduce your loan term and the total interest paid. Even small additional payments can make a big difference over time.",refinanceTitle:"When to Consider Refinancing",refinanceContent:"Refinancing may be beneficial in the following situations:",refinanceTip1:"When interest rates have dropped significantly since you obtained your loan.",refinanceTip2:"When you want to change the term of your loan (shorter or longer).",refinanceTip3:"When you want to switch from a variable to a fixed-rate loan or vice versa."},tutorial:{loanTypeTitle:"Loan Type",loanTypeContent:"Start by selecting the type of loan you need. This will set appropriate defaults for your loan calculation.",loanAmountTitle:"Loan Amount",loanAmountContent:"Enter the total amount you wish to borrow. You can use the slider or type the exact amount.",interestRateTitle:"Interest Rate",interestRateContent:"Enter the annual interest rate for your loan. This is the cost of borrowing the money, expressed as a percentage.",loanTermTitle:"Loan Term",loanTermContent:"Enter the length of time to repay the loan in months. Longer terms mean lower monthly payments but more interest paid overall.",termPresetsTitle:"Term Presets",termPresetsContent:"Click these buttons to quickly set common loan terms like 5, 15, or 30 years.",additionalPaymentTitle:"Additional Payment",additionalPaymentContent:"Enter any extra amount you plan to pay each period. This can significantly reduce your loan term and total interest.",calculateTitle:"Calculate",calculateContent:"Click this button to calculate your loan based on the entered parameters.",resultsTitle:"Results Summary",resultsContent:"This section shows your monthly payment, total payment, total interest, and payoff date.",amortizationTitle:"Amortization Schedule",amortizationContent:"This table shows the breakdown of each payment over the life of the loan, including how much goes to principal and interest.",chartsTitle:"Payment Charts",chartsContent:"These charts visualize your loan data, showing the breakdown of principal vs. interest and the amortization schedule over time.",completedTitle:"Tutorial Completed",completedContent:"You've completed the tutorial! You now know how to use the loan calculator to make informed financial decisions."}},es:{form:{title:"Calculadora de Pr\xe9stamos",loanAmount:"Monto del Pr\xe9stamo",interestRate:"Tasa de Inter\xe9s",loanTerm:"Plazo del Pr\xe9stamo",loanType:"Tipo de Pr\xe9stamo",paymentFrequency:"Frecuencia de Pago",downPayment:"Pago Inicial",additionalPayment:"Pago Adicional",startDate:"Fecha de Inicio",calculate:"Calcular",reset:"Reiniciar",years:"A\xf1os",months:"Meses",mortgage:"Hipoteca",auto:"Auto",personal:"Personal",student:"Estudiantil",monthly:"Mensual",biWeekly:"Quincenal",weekly:"Semanal"},marketRates:{title:"Tasas Actuales del Mercado",disclaimer:"Las tasas son estimaciones basadas en promedios nacionales y pueden variar seg\xfan la ubicaci\xf3n, puntaje crediticio y otros factores.",averageRate:"Tasa Promedio",rateRange:"Rango de Tasas",yourRate:"Su Tasa",difference:"Diferencia",belowAverage:"por debajo del promedio",aboveAverage:"por encima del promedio",sameAsAverage:"igual al promedio",useAverageRate:"Usar Tasa Promedio",lastUpdated:"\xdaltima Actualizaci\xf3n",viewTrends:"Ver Tendencias de Tasas",compareRates:"Comparar Su Tasa"},glossary:{title:"Glosario de T\xe9rminos Financieros",openGlossary:"Abrir Glosario de T\xe9rminos Financieros",close:"Cerrar Glosario",search:"Buscar t\xe9rminos en el glosario",searchPlaceholder:"Buscar t\xe9rminos...",noResults:"No se encontraron t\xe9rminos coincidentes",searchResults:"{count} t\xe9rminos encontrados",opened:"Glosario financiero abierto",closed:"Glosario financiero cerrado"},results:{monthlyPayment:"Pago Mensual",totalPayment:"Pago Total",totalInterest:"Inter\xe9s Total",payoffDate:"Fecha de Liquidaci\xf3n",interestSavings:"Ahorro de Intereses",timeReduction:"Reducci\xf3n de Tiempo",saveCalculation:"Guardar C\xe1lculo",share:"Compartir",export:"Exportar",print:"Imprimir"},amortization:{title:"Tabla de Amortizaci\xf3n",paymentNumber:"# de Pago",paymentDate:"Fecha",payment:"Pago",principal:"Capital",interest:"Inter\xe9s",balance:"Saldo",totalPrincipal:"Capital Total",totalInterest:"Inter\xe9s Total",filter:"Filtrar",showAll:"Mostrar Todo",annual:"Resumen Anual",noData:"No hay datos disponibles"},charts:{title:"Gr\xe1ficos de Pago",principalVsInterest:"Capital vs Inter\xe9s",paymentBreakdown:"Desglose de Pagos",amortizationSchedule:"Calendario de Amortizaci\xf3n",principal:"Capital",interest:"Inter\xe9s",balance:"Saldo",time:"Tiempo"},savedCalculations:{title:"C\xe1lculos Guardados",noSavedCalculations:"No hay c\xe1lculos guardados",load:"Cargar",delete:"Eliminar",compare:"Comparar",rename:"Renombrar",confirmDelete:"\xbfEst\xe1 seguro de que desea eliminar este c\xe1lculo?",enterName:"Ingrese un nombre para este c\xe1lculo",defaultName:"C\xe1lculo"},settings:{title:"Configuraci\xf3n",theme:"Tema",language:"Idioma",currency:"Moneda",light:"Claro",dark:"Oscuro",dateFormat:"Formato de Fecha",numberFormat:"Formato de N\xfamero"},comparison:{title:"Comparaci\xf3n de Pr\xe9stamos",scenario:"Escenario",difference:"Diferencia",savings:"Ahorros"},common:{yes:"S\xed",no:"No",ok:"Aceptar",cancel:"Cancelar",save:"Guardar",close:"Cerrar",loading:"Cargando...",error:"Ocurri\xf3 un error",success:"\xc9xito",warning:"Advertencia",info:"Informaci\xf3n"},tooltips:{loanType:"Seleccione el tipo de pr\xe9stamo que necesita. Diferentes tipos de pr\xe9stamos tienen diferentes valores y l\xedmites predeterminados.",loanAmount:"Ingrese el monto total que desea pedir prestado.",interestRate:"La tasa de inter\xe9s anual de su pr\xe9stamo. Tasas m\xe1s altas significan pagos mensuales m\xe1s altos.",loanTerm:"El per\xedodo de tiempo para pagar el pr\xe9stamo. Plazos m\xe1s largos significan pagos mensuales m\xe1s bajos pero m\xe1s intereses pagados en general.",downPayment:"Pago inicial realizado por adelantado. Un pago inicial m\xe1s grande reduce el monto de su pr\xe9stamo y los pagos mensuales.",additionalPayment:"Cantidad adicional pagada en cada per\xedodo m\xe1s all\xe1 del pago requerido. Esto reduce el plazo de su pr\xe9stamo y el inter\xe9s total.",paymentFrequency:"Con qu\xe9 frecuencia realiza los pagos. Pagos m\xe1s frecuentes pueden reducir el inter\xe9s total pagado.",startDate:"La fecha en que comienza su pr\xe9stamo y vence el primer pago.",monthlyPayment:"La cantidad que debe pagar en cada per\xedodo para pagar el pr\xe9stamo seg\xfan lo programado.",totalPayment:"El monto total que pagar\xe1 durante la vida del pr\xe9stamo, incluido el capital y los intereses.",totalInterest:"El monto total de inter\xe9s que pagar\xe1 durante la vida del pr\xe9stamo.",payoffDate:"La fecha en que su pr\xe9stamo se pagar\xe1 por completo si realiza todos los pagos programados.",interestSavings:"La cantidad de inter\xe9s que ahorra al realizar pagos adicionales.",startTutorial:"Inicie un recorrido guiado por las funciones de la calculadora de pr\xe9stamos.",showGuidance:"Mostrar orientaci\xf3n para interpretar los resultados de su pr\xe9stamo.",interpretingResults:"C\xf3mo interpretar los resultados del c\xe1lculo de su pr\xe9stamo",affordabilityGuidance:"Comprender la asequibilidad del pr\xe9stamo",refinanceGuidance:"Cu\xe1ndo considerar la refinanciaci\xf3n"},guidance:{title:"Gu\xeda de la Calculadora de Pr\xe9stamos",help:"Ayuda y Consejos",tutorial:"Tutorial Interactivo",interpretingResultsTitle:"Interpretando Sus Resultados",interpretingResultsContent:"Los resultados del c\xe1lculo de su pr\xe9stamo muestran el pago mensual, el pago total, el inter\xe9s total y la fecha de liquidaci\xf3n. El pago mensual es la cantidad que debe pagar en cada per\xedodo para pagar el pr\xe9stamo seg\xfan lo programado. El pago total es la suma de todos los pagos durante la vida del pr\xe9stamo. El inter\xe9s total es el costo de pedir prestado el dinero.",affordabilityTitle:"Entendiendo la Asequibilidad del Pr\xe9stamo",affordabilityContent:"Al determinar cu\xe1nto puede permitirse pedir prestado, considere lo siguiente:",affordabilityTip1:"Su pago mensual del pr\xe9stamo deber\xeda ser idealmente menos del 28% de su ingreso mensual bruto.",affordabilityTip2:"Considere todas las otras deudas y gastos al determinar la asequibilidad.",affordabilityTip3:"Recuerde tener en cuenta los impuestos, el seguro y los costos de mantenimiento para las hipotecas.",additionalPaymentsTitle:"Beneficios de los Pagos Adicionales",additionalPaymentsContent:"Hacer pagos adicionales puede reducir significativamente el plazo de su pr\xe9stamo y el inter\xe9s total pagado. Incluso peque\xf1os pagos adicionales pueden hacer una gran diferencia con el tiempo.",refinanceTitle:"Cu\xe1ndo Considerar la Refinanciaci\xf3n",refinanceContent:"La refinanciaci\xf3n puede ser beneficiosa en las siguientes situaciones:",refinanceTip1:"Cuando las tasas de inter\xe9s han bajado significativamente desde que obtuvo su pr\xe9stamo.",refinanceTip2:"Cuando desea cambiar el plazo de su pr\xe9stamo (m\xe1s corto o m\xe1s largo).",refinanceTip3:"Cuando desea cambiar de un pr\xe9stamo de tasa variable a uno de tasa fija o viceversa."},tutorial:{loanTypeTitle:"Tipo de Pr\xe9stamo",loanTypeContent:"Comience seleccionando el tipo de pr\xe9stamo que necesita. Esto establecer\xe1 los valores predeterminados apropiados para su c\xe1lculo de pr\xe9stamo.",loanAmountTitle:"Monto del Pr\xe9stamo",loanAmountContent:"Ingrese el monto total que desea pedir prestado. Puede usar el control deslizante o escribir el monto exacto.",interestRateTitle:"Tasa de Inter\xe9s",interestRateContent:"Ingrese la tasa de inter\xe9s anual para su pr\xe9stamo. Este es el costo de pedir prestado el dinero, expresado como un porcentaje.",loanTermTitle:"Plazo del Pr\xe9stamo",loanTermContent:"Ingrese el per\xedodo de tiempo para pagar el pr\xe9stamo en meses. Plazos m\xe1s largos significan pagos mensuales m\xe1s bajos pero m\xe1s intereses pagados en general.",termPresetsTitle:"Plazos Preestablecidos",termPresetsContent:"Haga clic en estos botones para establecer r\xe1pidamente plazos comunes de pr\xe9stamos como 5, 15 o 30 a\xf1os.",additionalPaymentTitle:"Pago Adicional",additionalPaymentContent:"Ingrese cualquier cantidad adicional que planea pagar en cada per\xedodo. Esto puede reducir significativamente el plazo de su pr\xe9stamo y el inter\xe9s total.",calculateTitle:"Calcular",calculateContent:"Haga clic en este bot\xf3n para calcular su pr\xe9stamo seg\xfan los par\xe1metros ingresados.",resultsTitle:"Resumen de Resultados",resultsContent:"Esta secci\xf3n muestra su pago mensual, pago total, inter\xe9s total y fecha de liquidaci\xf3n.",amortizationTitle:"Tabla de Amortizaci\xf3n",amortizationContent:"Esta tabla muestra el desglose de cada pago durante la vida del pr\xe9stamo, incluido cu\xe1nto va al capital y al inter\xe9s.",chartsTitle:"Gr\xe1ficos de Pago",chartsContent:"Estos gr\xe1ficos visualizan los datos de su pr\xe9stamo, mostrando el desglose de capital versus inter\xe9s y el calendario de amortizaci\xf3n a lo largo del tiempo.",completedTitle:"Tutorial Completado",completedContent:"\xa1Ha completado el tutorial! Ahora sabe c\xf3mo usar la calculadora de pr\xe9stamos para tomar decisiones financieras informadas."}}};function i(t,e="en"){const a=t.split(".");let i=n[e]||n.en;for(const n of a)if(i=i[n],void 0===i)return t;return i}function s(t="en"){return n[t]||n.en}function r(){return[{code:"en",name:"English"},{code:"es",name:"Espa\xf1ol"}]}},719:function(t,e,a){function n(t=document){t.querySelectorAll("[data-tooltip]").forEach(t=>{let e=t.querySelector(".tooltip");if(!e){e=document.createElement("div"),e.className="tooltip",e.setAttribute("role","tooltip"),e.setAttribute("aria-hidden","true");const a=t.getAttribute("data-tooltip");e.textContent=a,t.appendChild(e),"static"===getComputedStyle(t).position&&(t.style.position="relative")}t.addEventListener("mouseenter",i),t.addEventListener("mouseleave",s),t.addEventListener("focus",i),t.addEventListener("blur",s),t.hasAttribute("tabindex")||t.setAttribute("tabindex","0");const a=`tooltip-${Math.random().toString(36).substr(2,9)}`;e.id=a,t.setAttribute("aria-describedby",a)})}function i(t){const e=t.currentTarget,a=e.querySelector(".tooltip");if(a){!function(t,e){const a=t.getAttribute("data-tooltip-position")||"top";e.classList.remove("tooltip-top","tooltip-bottom","tooltip-left","tooltip-right"),e.classList.add(`tooltip-${a}`),setTimeout(()=>{const t=e.getBoundingClientRect(),n=window.innerWidth,i=window.innerHeight;t.left<0?(e.classList.remove(`tooltip-${a}`),e.classList.add("tooltip-right")):t.right>n?(e.classList.remove(`tooltip-${a}`),e.classList.add("tooltip-left")):t.top<0?(e.classList.remove(`tooltip-${a}`),e.classList.add("tooltip-bottom")):t.bottom>i&&(e.classList.remove(`tooltip-${a}`),e.classList.add("tooltip-top"))},0)}(e,a),a.classList.add("visible"),a.setAttribute("aria-hidden","false");!function(t){let e=document.getElementById("tooltip-announcer");e||(e=document.createElement("div"),e.id="tooltip-announcer",e.setAttribute("aria-live","polite"),e.setAttribute("aria-atomic","true"),e.classList.add("sr-only"),document.body.appendChild(e));e.textContent="",e.offsetWidth,e.textContent=t}(e.getAttribute("data-tooltip"))}}function s(t){const e=t.currentTarget.querySelector(".tooltip");e&&(e.classList.remove("visible"),e.setAttribute("aria-hidden","true"))}function r(t,e,a,n){if(!t)return null;const i=document.createElement("div");i.className="guidance-panel",i.id=n||`guidance-${Math.random().toString(36).substr(2,9)}`,i.innerHTML=`\n    <div class="guidance-header">\n      <h3>${e}</h3>\n      <button class="guidance-close" aria-label="Close guidance">\xd7</button>\n    </div>\n    <div class="guidance-content">\n      ${a}\n    </div>\n  `;const s=i.querySelector(".guidance-close");return s&&s.addEventListener("click",()=>{i.classList.add("guidance-hidden"),setTimeout(()=>{i.remove()},300)}),t.appendChild(i),setTimeout(()=>{i.classList.add("guidance-visible")},10),i}function o(t,e){if(!t||!t.length)return;let a=0;const n=document.createElement("div");function i(e){const i=document.querySelector(e.selector);if(!i)return void r();!function(t){const e=t.getBoundingClientRect();let a=document.querySelector(".tutorial-highlight");a||(a=document.createElement("div"),a.className="tutorial-highlight",n.appendChild(a));a.style.top=e.top-10+"px",a.style.left=e.left-10+"px",a.style.width=`${e.width+20}px`,a.style.height=`${e.height+20}px`}(i);const o=document.createElement("div");o.className="tutorial-tooltip",o.innerHTML=`\n      <div class="tutorial-content">\n        <h3>${e.title}</h3>\n        <p>${e.content}</p>\n      </div>\n      <div class="tutorial-controls">\n        <button class="tutorial-prev" ${0===a?"disabled":""}>Previous</button>\n        <span class="tutorial-progress">${a+1}/${t.length}</span>\n        <button class="tutorial-next">${a===t.length-1?"Finish":"Next"}</button>\n      </div>\n    `,function(t,e,a){const n=e.getBoundingClientRect(),i=t.getBoundingClientRect();switch(a){case"top":t.style.top=n.top-i.height-20+"px",t.style.left=n.left+n.width/2-i.width/2+"px";break;case"bottom":default:t.style.top=`${n.bottom+20}px`,t.style.left=n.left+n.width/2-i.width/2+"px";break;case"left":t.style.top=n.top+n.height/2-i.height/2+"px",t.style.left=n.left-i.width-20+"px";break;case"right":t.style.top=n.top+n.height/2-i.height/2+"px",t.style.left=`${n.right+20}px`}const s=window.innerWidth,r=window.innerHeight;parseFloat(t.style.left)<20?t.style.left="20px":parseFloat(t.style.left)+i.width>s-20&&(t.style.left=s-i.width-20+"px");parseFloat(t.style.top)<20?t.style.top="20px":parseFloat(t.style.top)+i.height>r-20&&(t.style.top=r-i.height-20+"px")}(o,i,e.position||"bottom"),document.body.appendChild(o);const l=o.querySelector(".tutorial-prev"),c=o.querySelector(".tutorial-next");l&&l.addEventListener("click",s),c&&c.addEventListener("click",r),e.action&&"function"===typeof e.action&&e.action(i)}function s(){if(a>0){const e=document.querySelector(".tutorial-tooltip");e&&e.remove(),a--,i(t[a])}}function r(){const s=document.querySelector(".tutorial-tooltip");if(s&&s.remove(),a===t.length-1)return n.remove(),void(e&&"function"===typeof e&&e());a++,i(t[a])}n.className="tutorial-overlay",document.body.appendChild(n),i(t[a])}a.d(e,{Dc:function(){return n},Xo:function(){return o},ZB:function(){return r}})},741:function(t,e,a){a.r(e);var n=a(154);e.default=class{constructor(t={}){this.container=t.container||document.getElementById("charts-container"),this.colorScheme=t.colorScheme||{principal:"#007bff",interest:"#dc3545",balance:"#28a745",comparison:["#4e73df","#1cc88a","#36b9cc","#f6c23e"]},this.chartInstances={principalVsInterest:null,paymentBreakdown:null,comparison:null},this.theme="light",this.init()}init(){this.container&&(this._createChartContainers(),this._initEventListeners())}_createChartContainers(){if(!this.container.querySelector("#principal-interest-chart")){const t=document.createElement("div");t.id="principal-interest-chart",t.className="chart-container",t.innerHTML='\n        <div class="chart-title">Principal vs. Interest Over Time</div>\n        <canvas></canvas>\n        <div class="chart-legend"></div>\n      ',this.container.appendChild(t)}if(!this.container.querySelector("#payment-breakdown-chart")){const t=document.createElement("div");t.id="payment-breakdown-chart",t.className="chart-container",t.innerHTML='\n        <div class="chart-title">Payment Breakdown</div>\n        <canvas></canvas>\n        <div class="chart-legend"></div>\n      ',this.container.appendChild(t)}if(!this.container.querySelector("#comparison-chart")){const t=document.createElement("div");t.id="comparison-chart",t.className="chart-container",t.style.display="none",t.innerHTML='\n        <div class="chart-title">Loan Comparison</div>\n        <canvas></canvas>\n        <div class="chart-legend"></div>\n      ',this.container.appendChild(t)}if(!this.container.querySelector("#inflation-impact-chart")){const t=document.createElement("div");t.id="inflation-impact-chart",t.className="chart-container",t.style.display="none",t.innerHTML='\n        <div class="chart-title">Inflation Impact on Payments</div>\n        <canvas></canvas>\n        <div class="chart-legend"></div>\n      ',this.container.appendChild(t)}}_initEventListeners(){window.addEventListener("resize",()=>{this._resizeCharts()})}_resizeCharts(){Object.values(this.chartInstances).forEach(t=>{t&&t.resize()})}renderPrincipalVsInterestChart(t){if(!this.container||!t||!t.loan||!t.amortizationSchedule)return;const e=this.container.querySelector("#principal-interest-chart");if(!e)return;e.style.display="block";const a=e.querySelector("canvas");if(!a)return;const{loan:i,amortizationSchedule:s}=t,{payments:r}=s,o=Math.max(1,Math.floor(r.length/60)),l=r.filter((t,e)=>e%o===0||e===r.length-1),c=l.map(t=>t.number),d=l.map(t=>t.principal),u=l.map(t=>t.interest),m=l.map(t=>t.balance);this.chartInstances.principalVsInterest&&this.chartInstances.principalVsInterest.destroy(),this.chartInstances.principalVsInterest=new n.t1(a,{type:"line",data:{labels:c,datasets:[{label:"Principal",data:d,backgroundColor:this.colorScheme.principal,borderColor:this.colorScheme.principal,borderWidth:2,fill:!1,tension:.1},{label:"Interest",data:u,backgroundColor:this.colorScheme.interest,borderColor:this.colorScheme.interest,borderWidth:2,fill:!1,tension:.1},{label:"Remaining Balance",data:m,backgroundColor:this.colorScheme.balance,borderColor:this.colorScheme.balance,borderWidth:2,fill:!1,tension:.1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{tooltip:{mode:"index",intersect:!1,callbacks:{label(t){let e=t.dataset.label||"";return e&&(e+=": "),null!==t.parsed.y&&(e+=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t.parsed.y)),e}}},legend:{position:"bottom",labels:{boxWidth:12,padding:15}},title:{display:!1}},scales:{x:{title:{display:!0,text:"Payment Number"},ticks:{maxTicksLimit:10}},y:{title:{display:!0,text:"Amount ($)"},ticks:{callback(t){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(t)}}}}}}),this._applyChartTheme(this.chartInstances.principalVsInterest)}renderPaymentBreakdownPieChart(t){if(!this.container||!t||!t.loan||!t.amortizationSchedule)return;const e=this.container.querySelector("#payment-breakdown-chart");if(!e)return;e.style.display="block";const a=e.querySelector("canvas");if(!a)return;const{loan:i,amortizationSchedule:s}=t,r=i.totalLoanAmount,o=s.totalInterest;this.chartInstances.paymentBreakdown&&this.chartInstances.paymentBreakdown.destroy(),this.chartInstances.paymentBreakdown=new n.t1(a,{type:"pie",data:{labels:["Principal","Interest"],datasets:[{data:[r,o],backgroundColor:[this.colorScheme.principal,this.colorScheme.interest],borderColor:["dark"===this.theme?"#2c3034":"#ffffff","dark"===this.theme?"#2c3034":"#ffffff"],borderWidth:1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{tooltip:{callbacks:{label(t){const e=t.label||"",a=t.raw,n=t.dataset.data.reduce((t,e)=>t+e,0),i=Math.round(a/n*100);return`${e}: ${new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a)} (${i}%)`}}},legend:{position:"bottom",labels:{boxWidth:12,padding:15}}}}}),this._applyChartTheme(this.chartInstances.paymentBreakdown)}renderComparisonChart(t){if(!this.container||!t||t.length<2)return;const e=this.container.querySelector("#comparison-chart");if(!e)return;e.style.display="block";const a=e.querySelector("canvas");if(!a)return;const i=t.map((t,e)=>{const{loan:a,amortizationSchedule:n}=t,i=a.paymentAmount,s=n?n.totalInterest:a.totalInterest,r=n?n.totalPayment:a.paymentAmount*a.numberOfPayments;return{label:t.name||`Scenario ${e+1}`,data:[i,s,r],backgroundColor:this.colorScheme.comparison[e%this.colorScheme.comparison.length],borderColor:"dark"===this.theme?"#2c3034":"#ffffff",borderWidth:1}});this.chartInstances.comparison&&this.chartInstances.comparison.destroy(),this.chartInstances.comparison=new n.t1(a,{type:"bar",data:{labels:["Monthly Payment","Total Interest","Total Payment"],datasets:i},options:{responsive:!0,maintainAspectRatio:!1,plugins:{tooltip:{callbacks:{label(t){let e=t.dataset.label||"";return e&&(e+=": "),null!==t.parsed.y&&(e+=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t.parsed.y)),e}}},legend:{position:"bottom",labels:{boxWidth:12,padding:15}}},scales:{x:{title:{display:!0,text:"Metrics"}},y:{title:{display:!0,text:"Amount ($)"},ticks:{callback(t){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(t)}}}}}}),this._applyChartTheme(this.chartInstances.comparison)}updateChartTheme(t){"light"!==t&&"dark"!==t||(this.theme=t,Object.values(this.chartInstances).forEach(t=>{t&&this._applyChartTheme(t)}))}_applyChartTheme(t){if(!t)return;const e="dark"===this.theme,a=e?"#e9ecef":"#212529",n=e?"rgba(255, 255, 255, 0.1)":"rgba(0, 0, 0, 0.1)";t.options.scales&&Object.values(t.options.scales).forEach(t=>{t.ticks&&(t.ticks.color=a),t.title&&(t.title.color=a),t.grid&&(t.grid.color=n)}),t.options.plugins&&t.options.plugins.legend&&(t.options.plugins.legend.labels.color=a),"pie"!==t.config.type&&"doughnut"!==t.config.type||t.data.datasets.forEach(t=>{t.borderColor=e?"#2c3034":"#ffffff"}),t.update()}renderInflationImpactChart(t){if(!this.container||!t||!t.loan||!t.amortizationSchedule||!t.inflationAdjusted)return;const e=this.container.querySelector("#inflation-impact-chart");if(!e)return;e.style.display="block";const a=e.querySelector("canvas");if(!a)return;const{loan:i,amortizationSchedule:s,inflationAdjusted:r}=t,{payments:o}=r,l=Math.max(1,Math.floor(o.length/60)),c=o.filter((t,e)=>e%l===0||e===o.length-1),d=c.map(t=>t.number),u=c.map(t=>t.originalAmount),m=c.map(t=>t.inflationAdjustedAmount);this.chartInstances.inflationImpact&&this.chartInstances.inflationImpact.destroy(),this.chartInstances.inflationImpact=new n.t1(a,{type:"line",data:{labels:d,datasets:[{label:"Nominal Payment",data:u,backgroundColor:this.colorScheme.principal,borderColor:this.colorScheme.principal,borderWidth:2,fill:!1,tension:.1},{label:"Inflation-Adjusted Payment",data:m,backgroundColor:this.colorScheme.balance,borderColor:this.colorScheme.balance,borderWidth:2,fill:!1,tension:.1}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{tooltip:{mode:"index",intersect:!1,callbacks:{label(t){let e=t.dataset.label||"";return e&&(e+=": "),null!==t.parsed.y&&(e+=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t.parsed.y)),e}}},legend:{position:"bottom",labels:{boxWidth:12,padding:15}},title:{display:!0,text:`Inflation Rate: ${r.summary.inflationRate}%`}},scales:{x:{title:{display:!0,text:"Payment Number"},ticks:{maxTicksLimit:10}},y:{title:{display:!0,text:"Payment Amount ($)"},ticks:{callback(t){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:0}).format(t)}}}}}}),this._applyChartTheme(this.chartInstances.inflationImpact);const h=e.querySelector(".chart-legend");if(h){const t=r.summary.savingsFromInflation,e=r.summary.totalOriginalPayment,a=r.summary.totalInflationAdjustedPayment,n=t/e*100;h.innerHTML=`\n        <div class="inflation-summary">\n          <div class="summary-item">\n            <span class="label">Total Nominal Payments:</span>\n            <span class="value">${new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e)}</span>\n          </div>\n          <div class="summary-item">\n            <span class="label">Total Inflation-Adjusted Payments:</span>\n            <span class="value">${new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a)}</span>\n          </div>\n          <div class="summary-item highlight">\n            <span class="label">Real Savings Due to Inflation:</span>\n            <span class="value">${new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(t)} (${n.toFixed(1)}%)</span>\n          </div>\n        </div>\n      `}}clear(){Object.keys(this.chartInstances).forEach(t=>{this.chartInstances[t]&&(this.chartInstances[t].destroy(),this.chartInstances[t]=null)});["#principal-interest-chart","#payment-breakdown-chart","#comparison-chart","#inflation-impact-chart"].forEach(t=>{const e=this.container.querySelector(t);e&&(e.style.display="none")})}}},906:function(t,e,a){var n=a(663),i=a(935);e.A=class{constructor(t={}){this.container=t.container||document.getElementById("glossary-container"),this.language=t.language||"en",this.isOpen=!1,this.terms=this.getGlossaryTerms(),this.init()}init(){this.render(),this.bindEvents()}render(){if(!this.container)return;const t=t=>(0,n.sC)(t,this.language),e=`\n      <button id="glossary-toggle" class="glossary-toggle" aria-label="${t("glossary.openGlossary")}">\n        <span class="glossary-icon">\ud83d\udcda</span>\n        <span class="glossary-text">${t("glossary.title")}</span>\n      </button>\n    `,a=`\n      <div id="glossary-modal" class="glossary-modal" aria-hidden="true" role="dialog" aria-labelledby="glossary-title">\n        <div class="glossary-content">\n          <div class="glossary-header">\n            <h2 id="glossary-title">${t("glossary.title")}</h2>\n            <button id="glossary-close" class="glossary-close" aria-label="${t("glossary.close")}">\xd7</button>\n          </div>\n          <div class="glossary-search">\n            <input \n              type="text" \n              id="glossary-search-input" \n              class="glossary-search-input" \n              placeholder="${t("glossary.searchPlaceholder")}" \n              aria-label="${t("glossary.search")}"\n            >\n          </div>\n          <div class="glossary-terms" id="glossary-terms-list">\n            ${this.renderTermsList()}\n          </div>\n        </div>\n      </div>\n    `;this.container.innerHTML=e+a}renderTermsList(t=""){const e=t=>(0,n.sC)(t,this.language),a=t?this.terms.filter(e=>e.term.toLowerCase().includes(t.toLowerCase())||e.definition.toLowerCase().includes(t.toLowerCase())):this.terms;a.sort((t,e)=>t.term.localeCompare(e.term));const i=a.reduce((t,e)=>{const a=e.term.charAt(0).toUpperCase();return t[a]||(t[a]=[]),t[a].push(e),t},{});let s="";return 0===a.length?s=`<p class="glossary-no-results">${e("glossary.noResults")}</p>`:Object.keys(i).sort().forEach(t=>{s+=`\n          <div class="glossary-letter-group">\n            <h3 class="glossary-letter">${t}</h3>\n            <dl class="glossary-definitions">\n              ${i[t].map(t=>`\n                <div class="glossary-term">\n                  <dt>${t.term}</dt>\n                  <dd>${t.definition}</dd>\n                </div>\n              `).join("")}\n            </dl>\n          </div>\n        `}),s}bindEvents(){if(!this.container)return;const t=this.container.querySelector("#glossary-toggle");t&&t.addEventListener("click",()=>this.toggleGlossary());const e=this.container.querySelector("#glossary-close");e&&e.addEventListener("click",()=>this.closeGlossary());const a=this.container.querySelector("#glossary-search-input");a&&a.addEventListener("input",t=>this.handleSearch(t.target.value));const n=this.container.querySelector("#glossary-modal");n&&n.addEventListener("click",t=>{t.target===n&&this.closeGlossary()}),document.addEventListener("keydown",t=>{"Escape"===t.key&&this.isOpen&&this.closeGlossary()});const s=this.container.querySelector(".glossary-content");s&&(0,i.pX)(s)}toggleGlossary(){this.isOpen?this.closeGlossary():this.openGlossary()}openGlossary(){const t=this.container.querySelector("#glossary-modal"),e=this.container.querySelector("#glossary-toggle");if(t&&e){t.classList.add("open"),t.setAttribute("aria-hidden","false"),e.setAttribute("aria-expanded","true");const a=this.container.querySelector("#glossary-search-input");a&&setTimeout(()=>a.focus(),100),this.isOpen=!0,(0,i.gL)((0,n.sC)("glossary.opened",this.language))}}closeGlossary(){const t=this.container.querySelector("#glossary-modal"),e=this.container.querySelector("#glossary-toggle");t&&e&&(t.classList.remove("open"),t.setAttribute("aria-hidden","true"),e.setAttribute("aria-expanded","false"),e.focus(),this.isOpen=!1,(0,i.gL)((0,n.sC)("glossary.closed",this.language)))}handleSearch(t){const e=this.container.querySelector("#glossary-terms-list");if(e){e.innerHTML=this.renderTermsList(t);const a=t=>(0,n.sC)(t,this.language),s=this.terms.filter(e=>e.term.toLowerCase().includes(t.toLowerCase())||e.definition.toLowerCase().includes(t.toLowerCase()));(0,i.gL)(a("glossary.searchResults").replace("{count}",s.length))}}updateLanguage(t){this.language!==t&&(this.language=t,this.terms=this.getGlossaryTerms(),this.render(),this.bindEvents())}getGlossaryTerms(){return[{term:"Amortization",definition:"The process of spreading out a loan into a series of fixed payments over time. Each payment is allocated between the principal and the interest."},{term:"Annual Percentage Rate (APR)",definition:"The yearly cost of a loan, including interest and fees, expressed as a percentage."},{term:"Balloon Payment",definition:"A large payment due at the end of a loan term, common in certain mortgage and auto loans."},{term:"Collateral",definition:"An asset that a borrower offers as a way for a lender to secure the loan. If the borrower stops making payments, the lender can seize the collateral."},{term:"Compound Interest",definition:"Interest calculated on both the initial principal and the accumulated interest from previous periods."},{term:"Down Payment",definition:"An initial upfront payment made when purchasing an expensive item such as a home or car using a loan."},{term:"Equity",definition:"The difference between the current market value of an asset and the amount owed on it."},{term:"Fixed-Rate Loan",definition:"A loan where the interest rate remains the same throughout the term of the loan."},{term:"Grace Period",definition:"A set period of time after a payment due date during which a late fee will not be charged."},{term:"Interest",definition:"The cost of borrowing money, typically expressed as an annual percentage rate."},{term:"Loan Term",definition:"The period of time during which a borrower makes monthly payments towards a loan."},{term:"Loan-to-Value (LTV) Ratio",definition:"The ratio of a loan amount to the value of the asset purchased, typically expressed as a percentage."},{term:"Mortgage",definition:"A loan used to purchase real estate, where the property serves as collateral."},{term:"Principal",definition:"The original amount of money borrowed in a loan, or the amount still owed, not including interest."},{term:"Refinancing",definition:"The process of replacing an existing loan with a new loan, typically with better terms."},{term:"Simple Interest",definition:"Interest calculated only on the principal amount, not on accumulated interest."},{term:"Underwriting",definition:"The process a lender uses to determine if the risk of offering a loan to a particular borrower under certain parameters is acceptable."},{term:"Variable-Rate Loan",definition:"A loan where the interest rate can change over time, based on an underlying benchmark or index."},{term:"Debt-to-Income Ratio",definition:"A personal finance measure that compares the amount of debt you have to your overall income."},{term:"Escrow",definition:"An account held by a third party on behalf of two other parties in a transaction."},{term:"Foreclosure",definition:"The legal process by which a lender takes control of a property, evicts the homeowner, and sells the home after the homeowner is unable to make full principal and interest payments on their mortgage."},{term:"Origination Fee",definition:"A fee charged by a lender for processing a new loan application, often expressed as a percentage of the loan amount."},{term:"Points",definition:"Fees paid to the lender at closing in exchange for a reduced interest rate. One point equals one percent of the loan amount."},{term:"Prepayment Penalty",definition:"A fee charged by some lenders when a borrower pays off a loan before the end of the loan term."},{term:"Private Mortgage Insurance (PMI)",definition:"Insurance that protects the lender if a borrower stops making payments on a loan. PMI is typically required for loans with a down payment of less than 20%."}]}}},935:function(t,e,a){function n(t,e='a, button, input, select, textarea, [tabindex]:not([tabindex="-1"])',a=!0){if(!t)return;const n=t.querySelectorAll(e);0!==n.length&&t.addEventListener("keydown",t=>{if("Tab"===t.key){const e=n[0],i=n[n.length-1];t.shiftKey&&document.activeElement===e?a&&(t.preventDefault(),i.focus()):t.shiftKey||document.activeElement!==i||a&&(t.preventDefault(),e.focus())}})}function i(t,e="polite"){let a=document.getElementById("screen-reader-announcer");a||(a=document.createElement("div"),a.id="screen-reader-announcer",a.setAttribute("aria-live",e),a.setAttribute("aria-atomic","true"),a.classList.add("sr-only"),document.body.appendChild(a)),a.textContent="",a.offsetWidth,a.textContent=t}function s(t="en"){document.documentElement.setAttribute("lang",t);["ar","he","fa","ur"].includes(t)?document.documentElement.setAttribute("dir","rtl"):document.documentElement.setAttribute("dir","ltr")}a.d(e,{gL:function(){return i},nE:function(){return s},pX:function(){return n}})},944:function(t,e,a){var n=a(122),i=(a(287),a(478));e.A=class{constructor(t={}){this.storageService=t.storageService||new n.A,this.maxComparisons=t.maxComparisons||3,this.selectedCalculations=[]}getAllCalculations(){return this.storageService.getCalculations().map(t=>({...t,isSelected:this.isSelected(t.loan.id),formattedDate:this._formatDate(t.savedAt)})).sort((t,e)=>e.savedAt-t.savedAt)}getCalculation(t){return this.storageService.getCalculationById(t)}saveCalculation(t,e=null,a=null){return a&&a.trim()&&(t=t.update({name:a.trim()})),this.storageService.saveCalculation(t,e)}updateCalculation(t,e={}){const a=this.storageService.getCalculationById(t);if(!a)return!1;let n=a.loan;e.name&&(n=n.update({name:e.name.trim()})),e.loanUpdates&&(n=n.update(e.loanUpdates));let s=a.amortizationSchedule;return e.loanUpdates&&(s=new i.AmortizationSchedule(n)),this.storageService.updateCalculation(t,n,s)}deleteCalculation(t){return this.deselectCalculation(t),this.storageService.deleteCalculation(t)}selectCalculation(t){return!!this.isSelected(t)||!(this.selectedCalculations.length>=this.maxComparisons)&&(this.selectedCalculations.push(t),!0)}deselectCalculation(t){const e=this.selectedCalculations.indexOf(t);return-1!==e&&(this.selectedCalculations.splice(e,1),!0)}isSelected(t){return this.selectedCalculations.includes(t)}clearSelection(){this.selectedCalculations=[]}getSelectedCalculations(){return this.selectedCalculations.map(t=>{const e=this.storageService.getCalculationById(t);return e?{id:t,loan:e.loan,amortizationSchedule:e.amortizationSchedule,savedAt:e.savedAt}:null}).filter(t=>null!==t)}compareCalculations(){const t=this.getSelectedCalculations();if(t.length<2)return{success:!1,message:"At least two calculations must be selected for comparison"};return{success:!0,comparison:{calculations:t,metrics:this._generateComparisonMetrics(t),differences:this._calculateDifferences(t)}}}_generateComparisonMetrics(t){return t.map(t=>{const{loan:e}=t,a=t.amortizationSchedule;return{id:t.id,name:e.name,principal:e.principal,downPayment:e.downPayment,loanAmount:e.totalLoanAmount,interestRate:e.interestRate,term:e.term,paymentFrequency:e.paymentFrequency,paymentAmount:e.paymentAmount,totalInterest:a?a.totalInterest:e.totalInterest,totalPayment:a?a.totalPayment:e.paymentAmount*e.numberOfPayments,payoffDate:a?a.payoffDate:e.payoffDate}})}_calculateDifferences(t){if(t.length<2)return{};const e=t[0],a={};for(let n=1;n<t.length;n++){const i=t[n],s={paymentDifference:i.loan.paymentAmount-e.loan.paymentAmount,interestDifference:0,totalPaymentDifference:0,termDifference:i.loan.term-e.loan.term};e.amortizationSchedule&&i.amortizationSchedule?(s.interestDifference=i.amortizationSchedule.totalInterest-e.amortizationSchedule.totalInterest,s.totalPaymentDifference=i.amortizationSchedule.totalPayment-e.amortizationSchedule.totalPayment):(s.interestDifference=i.loan.paymentAmount*i.loan.numberOfPayments-e.loan.paymentAmount*e.loan.numberOfPayments,s.totalPaymentDifference=s.interestDifference),a[i.id]=s}return a}_formatDate(t){return t?t.toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):""}organizeCalculations(t,e){return!0}getStorageStats(){return this.storageService.getStorageStats()}}},951:function(t,e,a){var n=a(663),i=a(364),s=a(935);e.A=class{constructor(t={}){this.currentLanguage=t.defaultLanguage||"en",this.storageKey="loan-calculator-language",this.listeners=[],this.loadLanguage()}loadLanguage(){try{const t=localStorage.getItem(this.storageKey);t&&(this.currentLanguage=t)}catch(t){}}saveLanguage(){try{localStorage.setItem(this.storageKey,this.currentLanguage)}catch(t){}}getLanguage(){return this.currentLanguage}getLocale(){return(0,i.Vb)(this.currentLanguage)}setLanguage(t){if(this.currentLanguage!==t){this.currentLanguage=t,this.saveLanguage(),(0,s.nE)(t),this.notifyListeners();const e=new CustomEvent("languagechange",{detail:{language:t}});document.dispatchEvent(e)}}translate(t){return(0,n.sC)(t,this.currentLanguage)}getAllTranslations(){return(0,n.$)(this.currentLanguage)}getAvailableLanguages(){return(0,n.hK)()}addListener(t){"function"!==typeof t||this.listeners.includes(t)||this.listeners.push(t)}removeListener(t){const e=this.listeners.indexOf(t);-1!==e&&this.listeners.splice(e,1)}notifyListeners(){this.listeners.forEach(t=>{try{t(this.currentLanguage)}catch(e){}})}}},962:function(t,e){e.A=class{constructor(t={}){this.container="string"===typeof t.container?document.getElementById(t.container):t.container||document.getElementById("settings-container"),this.onThemeChange=t.onThemeChange||(()=>{}),this.onLanguageChange=t.onLanguageChange||(()=>{}),this.onCurrencyChange=t.onCurrencyChange||(()=>{}),this.settings={theme:"light",language:"en",currency:"USD"},this.availableLanguages=[{code:"en",name:"English"},{code:"es",name:"Espa\xf1ol"}],this.availableCurrencies=[{code:"USD",symbol:"$",name:"US Dollar"},{code:"EUR",symbol:"\u20ac",name:"Euro"},{code:"GBP",symbol:"\xa3",name:"British Pound"},{code:"JPY",symbol:"\xa5",name:"Japanese Yen"},{code:"CAD",symbol:"C$",name:"Canadian Dollar"},{code:"AUD",symbol:"A$",name:"Australian Dollar"},{code:"MXN",symbol:"MX$",name:"Mexican Peso"}],this.storageKey="loan-calculator-settings",this.init()}init(){this.loadSettings(),this.applyTheme(this.settings.theme),this.render()}render(){if(!this.container)return;const t=document.createElement("div");t.className="settings-panel";const e=document.createElement("button");e.className="settings-toggle",e.setAttribute("aria-label","Open settings"),e.innerHTML='\n      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n        <circle cx="12" cy="12" r="3"></circle>\n        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>\n      </svg>\n    ';const a=document.createElement("div");a.className="settings-dropdown",a.setAttribute("aria-hidden","true");const n=document.createElement("div");n.className="settings-section",n.appendChild(this.createThemeToggle()),a.appendChild(n);const i=document.createElement("div");i.className="settings-section",i.appendChild(this.createLanguageSelector()),a.appendChild(i);const s=document.createElement("div");s.className="settings-section",s.appendChild(this.createCurrencySelector()),a.appendChild(s),t.appendChild(e),t.appendChild(a),this.container.innerHTML="",this.container.appendChild(t),e.addEventListener("click",()=>{const t=a.classList.contains("active");a.classList.toggle("active"),a.setAttribute("aria-hidden",t?"true":"false"),e.setAttribute("aria-label",t?"Open settings":"Close settings")}),document.addEventListener("click",n=>{!t.contains(n.target)&&a.classList.contains("active")&&(a.classList.remove("active"),a.setAttribute("aria-hidden","true"),e.setAttribute("aria-label","Open settings"))})}createThemeToggle(){const t=document.createElement("div"),e=document.createElement("h3");e.textContent="Theme",t.appendChild(e);const a=document.createElement("div");a.className="theme-toggle";const n=document.createElement("span");n.textContent="Light";const i=document.createElement("label");i.className="toggle-switch";const s=document.createElement("input");s.type="checkbox",s.checked="dark"===this.settings.theme,s.setAttribute("aria-label","Toggle dark theme");const r=document.createElement("span");r.className="toggle-slider";const o=document.createElement("span");return o.textContent="Dark",i.appendChild(s),i.appendChild(r),a.appendChild(n),a.appendChild(i),a.appendChild(o),t.appendChild(a),s.addEventListener("change",()=>{const t=s.checked?"dark":"light";this.settings.theme=t,this.saveSettings(),this.applyTheme(t),this.onThemeChange(t)}),t}createLanguageSelector(){const t=document.createElement("div"),e=document.createElement("h3");e.textContent="Language",t.appendChild(e);const a=document.createElement("select");return a.className="settings-select",a.setAttribute("aria-label","Select language"),this.availableLanguages.forEach(t=>{const e=document.createElement("option");e.value=t.code,e.textContent=t.name,e.selected=this.settings.language===t.code,a.appendChild(e)}),t.appendChild(a),a.addEventListener("change",()=>{const t=a.value;this.settings.language=t,this.saveSettings(),this.onLanguageChange(t)}),t}createCurrencySelector(){const t=document.createElement("div"),e=document.createElement("h3");e.textContent="Currency",t.appendChild(e);const a=document.createElement("select");return a.className="settings-select",a.setAttribute("aria-label","Select currency"),this.availableCurrencies.forEach(t=>{const e=document.createElement("option");e.value=t.code,e.textContent=`${t.symbol} - ${t.name}`,e.selected=this.settings.currency===t.code,a.appendChild(e)}),t.appendChild(a),a.addEventListener("change",()=>{const t=a.value;this.settings.currency=t,this.saveSettings(),this.onCurrencyChange(t)}),t}applyTheme(t){"dark"===t?(document.body.classList.add("dark-theme"),localStorage.setItem("theme","dark")):(document.body.classList.remove("dark-theme"),localStorage.setItem("theme","light"));const e=new CustomEvent("themechange",{detail:{theme:t}});document.dispatchEvent(e)}loadSettings(){try{const t=localStorage.getItem(this.storageKey);if(t){const e=JSON.parse(t);this.settings={...this.settings,...e}}}catch(t){}}saveSettings(){try{localStorage.setItem(this.storageKey,JSON.stringify(this.settings))}catch(t){}}getSettings(){return{...this.settings}}updateSettings(t){this.settings={...this.settings,...t},t.theme&&this.applyTheme(t.theme),this.saveSettings()}}},970:function(t,e,a){var n=a(944);e.A=class{constructor(t={}){this.containerId=t.containerId||"saved-calculations-container",this.calculationManager=t.calculationManager||new n.A,this.onLoadCalculation=t.onLoadCalculation||(()=>{}),this.onCompareCalculations=t.onCompareCalculations||(()=>{}),this.container=null,this.calculationsList=null,this.comparisonView=null,this.isComparisonMode=!1,this.initialize()}initialize(){this.container=document.getElementById(this.containerId),this.container&&(this.render(),this.attachEventListeners())}render(){this.container.innerHTML="";this.container.innerHTML='\n      <div class="saved-calculations-manager">\n        <div class="saved-calculations-header">\n          <h2>Saved Calculations</h2>\n          <div class="saved-calculations-actions">\n            <button id="compare-button" class="btn btn-secondary" disabled>Compare Selected</button>\n            <button id="clear-selection-button" class="btn btn-outline-secondary" disabled>Clear Selection</button>\n          </div>\n        </div>\n        \n        <div class="saved-calculations-content">\n          <div id="saved-calculations-list" class="saved-calculations-list">\n            <p class="empty-state-message">No saved calculations yet. Save a calculation to see it here.</p>\n          </div>\n          \n          <div id="comparison-view" class="comparison-view" style="display: none;">\n            <div class="comparison-header">\n              <h3>Comparison</h3>\n              <button id="close-comparison-button" class="btn btn-outline-secondary">Close</button>\n            </div>\n            <div id="comparison-content" class="comparison-content"></div>\n          </div>\n        </div>\n      </div>\n    ',this.calculationsList=document.getElementById("saved-calculations-list"),this.comparisonView=document.getElementById("comparison-view"),this.comparisonContent=document.getElementById("comparison-content"),this.compareButton=document.getElementById("compare-button"),this.clearSelectionButton=document.getElementById("clear-selection-button"),this.loadCalculations()}attachEventListeners(){const t=document.getElementById("compare-button");t&&t.addEventListener("click",()=>this.showComparison());const e=document.getElementById("clear-selection-button");e&&e.addEventListener("click",()=>this.clearSelection());const a=document.getElementById("close-comparison-button");a&&a.addEventListener("click",()=>this.hideComparison())}loadCalculations(){const t=this.calculationManager.getAllCalculations();0!==t.length?(this.calculationsList.innerHTML="",t.forEach(t=>{const e=this.createCalculationCard(t);this.calculationsList.appendChild(e)}),this.updateButtonStates()):this.calculationsList.innerHTML='\n        <p class="empty-state-message">No saved calculations yet. Save a calculation to see it here.</p>\n      '}createCalculationCard(t){const{loan:e,savedAt:a,isSelected:n}=t,i=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}),s=document.createElement("div");s.className="calculation-card "+(n?"selected":""),s.dataset.id=e.id,s.innerHTML=`\n      <div class="calculation-card-header">\n        <h3 class="calculation-name">${e.name||"Unnamed Calculation"}</h3>\n        <div class="calculation-date">${t.formattedDate}</div>\n      </div>\n      \n      <div class="calculation-card-content">\n        <div class="calculation-details">\n          <div class="detail-row">\n            <span class="detail-label">Loan Amount:</span>\n            <span class="detail-value">${i.format(e.totalLoanAmount)}</span>\n          </div>\n          <div class="detail-row">\n            <span class="detail-label">Interest Rate:</span>\n            <span class="detail-value">${e.interestRate}%</span>\n          </div>\n          <div class="detail-row">\n            <span class="detail-label">Term:</span>\n            <span class="detail-value">${e.term} months</span>\n          </div>\n          <div class="detail-row">\n            <span class="detail-label">Payment:</span>\n            <span class="detail-value">${i.format(e.paymentAmount)}</span>\n          </div>\n        </div>\n      </div>\n      \n      <div class="calculation-card-actions">\n        <button class="btn btn-primary load-btn">Load</button>\n        <button class="btn btn-outline-danger delete-btn">Delete</button>\n        <div class="select-calculation">\n          <input type="checkbox" id="select-${e.id}" class="select-checkbox" ${n?"checked":""}>\n          <label for="select-${e.id}">Select for comparison</label>\n        </div>\n      </div>\n    `;s.querySelector(".load-btn").addEventListener("click",()=>this.loadCalculation(e.id));s.querySelector(".delete-btn").addEventListener("click",()=>this.deleteCalculation(e.id));return s.querySelector(".select-checkbox").addEventListener("change",t=>{t.target.checked?this.selectCalculation(e.id,s):this.deselectCalculation(e.id,s)}),s}loadCalculation(t){const e=this.calculationManager.getCalculation(t);e&&this.onLoadCalculation(e)}deleteCalculation(t){if(confirm("Are you sure you want to delete this calculation?")){this.calculationManager.deleteCalculation(t)&&this.loadCalculations()}}selectCalculation(t,e){if(!this.calculationManager.selectCalculation(t)){return e.querySelector(".select-checkbox").checked=!1,void alert(`You can only select up to ${this.calculationManager.maxComparisons} calculations for comparison.`)}e.classList.add("selected"),this.updateButtonStates()}deselectCalculation(t,e){this.calculationManager.deselectCalculation(t),e.classList.remove("selected"),this.updateButtonStates()}clearSelection(){this.calculationManager.clearSelection();this.calculationsList.querySelectorAll(".calculation-card.selected").forEach(t=>{t.classList.remove("selected");t.querySelector(".select-checkbox").checked=!1}),this.updateButtonStates()}updateButtonStates(){const t=this.calculationManager.selectedCalculations.length;this.compareButton.disabled=t<2,this.clearSelectionButton.disabled=0===t}showComparison(){const t=this.calculationManager.compareCalculations();t.success?(this.isComparisonMode=!0,this.calculationsList.style.display="none",this.comparisonView.style.display="block",this.renderComparison(t.comparison),this.onCompareCalculations(t.comparison)):alert(t.message)}hideComparison(){this.isComparisonMode=!1,this.calculationsList.style.display="block",this.comparisonView.style.display="none"}renderComparison(t){const{calculations:e,metrics:a,differences:n}=t,i=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});let s=`\n      <table class="comparison-table">\n        <thead>\n          <tr>\n            <th>Metric</th>\n            ${a.map(t=>`<th>${t.name||"Unnamed"}</th>`).join("")}\n          </tr>\n        </thead>\n        <tbody>\n    `;if([{label:"Loan Amount",key:"loanAmount",format:t=>i.format(t)},{label:"Interest Rate",key:"interestRate",format:t=>`${t}%`},{label:"Term",key:"term",format:t=>`${t} months`},{label:"Payment Frequency",key:"paymentFrequency",format:t=>t},{label:"Payment Amount",key:"paymentAmount",format:t=>i.format(t)},{label:"Total Interest",key:"totalInterest",format:t=>i.format(t)},{label:"Total Payment",key:"totalPayment",format:t=>i.format(t)}].forEach(t=>{s+=`\n        <tr>\n          <td>${t.label}</td>\n          ${a.map(e=>`<td>${t.format(e[t.key])}</td>`).join("")}\n        </tr>\n      `}),a.length>1){s+=`\n        <tr class="comparison-separator">\n          <td colspan="${a.length+1}">Differences (compared to ${a[0].name||"first calculation"})</td>\n        </tr>\n      `;for(let t=1;t<a.length;t++){const e=n[a[t].id];e&&(s+=`\n            <tr>\n              <td>Monthly Payment Difference</td>\n              ${Array(t).fill("<td></td>").join("")}\n              <td class="${e.paymentDifference<0?"positive":"negative"}">${i.format(e.paymentDifference)}</td>\n              ${Array(a.length-t-1).fill("<td></td>").join("")}\n            </tr>\n            <tr>\n              <td>Total Interest Difference</td>\n              ${Array(t).fill("<td></td>").join("")}\n              <td class="${e.interestDifference<0?"positive":"negative"}">${i.format(e.interestDifference)}</td>\n              ${Array(a.length-t-1).fill("<td></td>").join("")}\n            </tr>\n            <tr>\n              <td>Total Payment Difference</td>\n              ${Array(t).fill("<td></td>").join("")}\n              <td class="${e.totalPaymentDifference<0?"positive":"negative"}">${i.format(e.totalPaymentDifference)}</td>\n              ${Array(a.length-t-1).fill("<td></td>").join("")}\n            </tr>\n          `)}}s+="\n        </tbody>\n      </table>\n    ",this.comparisonContent.innerHTML=s}refresh(){this.loadCalculations()}}}},function(t){t.O(0,[387,242,271],function(){return e=930,t(t.s=e);var e});t.O()}]);
//# sourceMappingURL=main-30c3a00b.babbf54c8e19507ff46f.js.map